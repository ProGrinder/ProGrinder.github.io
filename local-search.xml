<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2022-06-06-组会</title>
    <link href="/2022/06/05/Seminar/20220606-%E7%BB%84%E4%BC%9A/"/>
    <url>/2022/06/05/Seminar/20220606-%E7%BB%84%E4%BC%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="2022-06-06-组会"><a class="markdownIt-Anchor" href="#2022-06-06-组会"></a> 2022-06-06-组会</h1><h2 id="训练结果"><a class="markdownIt-Anchor" href="#训练结果"></a> 训练结果</h2><p>跑完了ReDet的训练(基于DOTAv1.0)</p><p>训练结果日志:</p><p>ap为平均精度</p><pre class="language-none"><code class="language-none">2022-05-31 13:41:46,926 - mmrotate - INFO - Saving checkpoint at 12 epochs2022-05-31 14:22:35,774 - mmrotate - INFO - +--------------------+-------+--------+--------+-------+| class              | gts   | dets   | recall | ap    |+--------------------+-------+--------+--------+-------+| plane              | 18788 | 23259  | 0.896  | 0.799 || baseball-diamond   | 1087  | 2135   | 0.724  | 0.651 || bridge             | 4181  | 4962   | 0.584  | 0.470 || ground-track-field | 733   | 1090   | 0.618  | 0.556 || small-vehicle      | 58868 | 110625 | 0.841  | 0.748 || large-vehicle      | 43075 | 74399  | 0.905  | 0.842 || ship               | 76153 | 88620  | 0.869  | 0.805 || tennis-court       | 5923  | 9230   | 0.937  | 0.904 || basketball-court   | 1180  | 2564   | 0.770  | 0.700 || storage-tank       | 13670 | 15183  | 0.674  | 0.622 || soccer-ball-field  | 827   | 2764   | 0.625  | 0.472 || roundabout         | 973   | 1973   | 0.623  | 0.544 || harbor             | 15468 | 22735  | 0.791  | 0.687 || swimming-pool      | 3836  | 8011   | 0.794  | 0.644 || helicopter         | 1189  | 1946   | 0.807  | 0.765 |+--------------------+-------+--------+--------+-------+| mAP                |       |        |        | 0.681 |+--------------------+-------+--------+--------+-------+2022-05-31 14:22:35,861 - mmrotate - INFO - Exp name: redet_re50_refpn_1x_dota_le90.py2022-05-31 14:22:35,861 - mmrotate - INFO - Epoch(val) [12][12800]mAP: 0.6807</code></pre><p>和论文中贴出来的结果表格的相比，总体mAP(平均精度均值)要少8个百分点:</p><p><img src="/img/article/2022/06/06/1.png" alt="" /></p><p>初步分析是因为Batch Size不一样， GPU不一样,:</p><p><img src="/img/article/2022/06/06/4.png" alt="" /></p><p>我租用的云服务器GPU是2080ti，因为第一次训练怕爆显存，我跑的时候batch_size设置成了1。</p><h2 id="日志分析"><a class="markdownIt-Anchor" href="#日志分析"></a> 日志分析</h2><p>分类损失和回归损失:</p><p>最终loss_rpn_cls: 0.0263, loss_rpn_bbox: 0.0228</p><p><img src="/img/article/2022/06/06/2.png" alt="" /></p><p>总Loss函数损失:</p><p>最终总loss: 0.5917</p><p><img src="/img/article/2022/06/06/3.png" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>组会</category>
      
    </categories>
    
    
    <tags>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022-05-30-组会</title>
    <link href="/2022/05/29/Seminar/20220530-%E7%BB%84%E4%BC%9A/"/>
    <url>/2022/05/29/Seminar/20220530-%E7%BB%84%E4%BC%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="2022-05-29-组会"><a class="markdownIt-Anchor" href="#2022-05-29-组会"></a> 2022-05-29-组会</h1><p>已经通过MMRotate框架，跑通了ReDet模型</p><p>目前正在训练,设置了一共跑12个epoch。</p><p>2022/5/29  17时，开始训练</p><p><img src="/img/article/2022/05/30/1.png" alt="" /></p><p>2022/5/30  14时, 正在跑第6个epoch，</p><p><img src="/img/article/2022/05/30/2.png" alt="" /></p><p>大概要跑到5月31日晚上</p>]]></content>
    
    
    <categories>
      
      <category>组会</category>
      
    </categories>
    
    
    <tags>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MMRotate框架学习(一)</title>
    <link href="/2022/05/22/AI-Learning/20220523-MMRotate/"/>
    <url>/2022/05/22/AI-Learning/20220523-MMRotate/</url>
    
    <content type="html"><![CDATA[<h1 id="mmrotate框架学习一"><a class="markdownIt-Anchor" href="#mmrotate框架学习一"></a> MMRotate框架学习(一)</h1><h2 id="mmrotate中的旋转框定义"><a class="markdownIt-Anchor" href="#mmrotate中的旋转框定义"></a> MMRotate中的旋转框定义</h2><p>图像空间采用右手坐标系 (y,x) ，即 y轴 是从上-&gt;下， x轴是从左-&gt;右。 此时存在2种相反的旋转方向，顺时针和逆时针。</p><h3 id="旋转变换"><a class="markdownIt-Anchor" href="#旋转变换"></a> 旋转变换</h3><h4 id="顺时针cw"><a class="markdownIt-Anchor" href="#顺时针cw"></a> 顺时针(CW)</h4><p>顺时针正角度，逆时针负角度。(<strong>上负下正</strong>)</p><pre class="language-none"><code class="language-none">0-------------------&gt; x (0 rad)|  A-------------B|  |             ||  |     box     h|  |   angle&#x3D;0   ||  D------w------Cvy (pi&#x2F;2 rad)</code></pre><h5 id="顺时针的旋转矩阵"><a class="markdownIt-Anchor" href="#顺时针的旋转矩阵"></a> 顺时针的旋转矩阵</h5><p>因为采用的是右手坐标系，所以顺时针的旋转矩阵与普通坐标系逆时针的旋转矩阵是一样的。</p><p>{\begin{split}\begin{pmatrix} \cos\alpha & -\sin\alpha \\ \sin\alpha & \cos\alpha \end{pmatrix}\end{split}}</p><h5 id="顺时针的旋转变换"><a class="markdownIt-Anchor" href="#顺时针的旋转变换"></a> 顺时针的旋转变换</h5><p>通过旋转变换，可以通过目标框中心点，求得旋转后目标框的任意点坐标的公式，在代码中实现。</p><p>\begin{split}P_A= \begin{pmatrix} x_A \\ y_A\end{pmatrix} = \begin{pmatrix} x_{center} \\ y_{center}\end{pmatrix} + \begin{pmatrix}\cos\alpha & -\sin\alpha \\ \sin\alpha & \cos\alpha\end{pmatrix} \begin{pmatrix} -0.5w \\ -0.5h\end{pmatrix} \\ = \begin{pmatrix} x_{center}-0.5w\cos\alpha+0.5h\sin\alpha \\ y_{center}-0.5w\sin\alpha-0.5h\cos\alpha\end{pmatrix}\end{split}</p><h4 id="逆时针ccw"><a class="markdownIt-Anchor" href="#逆时针ccw"></a> 逆时针(CCW)</h4><p>顺时针负角度，逆时针负角度。(上正下负)</p><pre class="language-none"><code class="language-none">0-------------------&gt; x (0 rad)|  A-------------B|  |             ||  |     box     h|  |   angle&#x3D;0   ||  D------w------Cvy (-pi&#x2F;2 rad)</code></pre><h5 id="逆时针的旋转矩阵"><a class="markdownIt-Anchor" href="#逆时针的旋转矩阵"></a> 逆时针的旋转矩阵</h5><p>\begin{split}\begin{pmatrix} \cos\alpha & \sin\alpha \\ -\sin\alpha & \cos\alpha \end{pmatrix}\end{split}</p><h5 id="逆时针的旋转变换"><a class="markdownIt-Anchor" href="#逆时针的旋转变换"></a> 逆时针的旋转变换</h5><p>{\begin{split}P_A= \begin{pmatrix} x_A \\ y_A\end{pmatrix} = \begin{pmatrix} x_{center} \\ y_{center}\end{pmatrix} + \begin{pmatrix}\cos\alpha & \sin\alpha \\ -\sin\alpha & \cos\alpha\end{pmatrix} \begin{pmatrix} -0.5w \\ -0.5h\end{pmatrix} \\ = \begin{pmatrix} x_{center}-0.5w\cos\alpha-0.5h\sin\alpha \\ y_{center}+0.5w\sin\alpha-0.5h\cos\alpha\end{pmatrix}\end{split}}</p><blockquote><p>在MMRotate中，旋转框的旋转方向默认为顺时针(CW)方向</p></blockquote><h3 id="旋转框定义"><a class="markdownIt-Anchor" href="#旋转框定义"></a> 旋转框定义</h3><h4 id="opencv定义法"><a class="markdownIt-Anchor" href="#opencv定义法"></a> OpenCV定义法</h4><h5 id="opencv旧版本定义451"><a class="markdownIt-Anchor" href="#opencv旧版本定义451"></a> OpenCV旧版本定义(&lt;4.5.1)</h5><p>OpenCV在版本4.5.1之前，表示形式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>w</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>θ</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>θ</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo>∈</mo><mo stretchy="false">[</mo><mo>−</mo><mi>π</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(x_{oc},y_{oc},w_{oc},h_{oc},{\theta}_{oc}),{\theta}_{oc}∈[-\pi/2,0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mord">/</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p><p>角度的由宽W与x轴所成的<strong>负的锐角或者直角</strong>。</p><h5 id="opencv新版本定义451"><a class="markdownIt-Anchor" href="#opencv新版本定义451"></a> OpenCV新版本定义(&gt;=4.5.1)</h5><p>OpenCV在版本4.5.1之后修改了角度定义范围，表示形式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>w</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo separator="true">,</mo><msub><mi>θ</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>θ</mi><mrow><mi>o</mi><mi>c</mi></mrow></msub><mo>∈</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>π</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{(x_{oc},y_{oc},w_{oc},h_{oc},{\theta}_{oc}),{\theta}_{oc}∈(0,\pi/2]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span></p><p>角度的由宽W与x轴所成的<strong>正的锐角或者直角</strong>。</p><p>新旧版本的转换关系如下图所示:</p><p><img src="/img/article/2022/05/23/2.jpg" alt="" /></p><blockquote><p>在MMRotate中，旋转框的定义方式采用OpenCV新版本定义法</p></blockquote><h2 id="mmrotate框架结构"><a class="markdownIt-Anchor" href="#mmrotate框架结构"></a> MMRotate框架结构</h2><p>MMRotate主要包括四个部分, <code>datasets</code>, <code>models</code>, <code>core</code> and <code>apis</code>。</p><ul><li><code>datasets</code> 用于数据加载和数据增强。</li><li><code>models</code> 主要包括各类模型和损失函数。</li><li><code>core</code> 为模型训练和评估提供工具。</li><li><code>apis</code> 为模型训练、测试和推理提供的API接口。</li></ul><p><img src="/img/article/2022/05/23/3.jpg" alt="" /></p><p>关于Dataset，目前已完成DOTA_v1.5、HRSC2016、SSDD的预处理，还剩下HRSID和DOTA_V1.0</p><p>关于Model, 目前在尝试跑Rotated-RetinaNet模型，使用HRSC2016，目前还在调整代码，目前没有遇到问题</p>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022-05-09-组会</title>
    <link href="/2022/05/08/Seminar/20220509-%E7%BB%84%E4%BC%9A/"/>
    <url>/2022/05/08/Seminar/20220509-%E7%BB%84%E4%BC%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="2022-05-09-组会"><a class="markdownIt-Anchor" href="#2022-05-09-组会"></a> 2022-05-09-组会</h1><h2 id="1redet"><a class="markdownIt-Anchor" href="#1redet"></a> 1.ReDet</h2><p>由于显示结果的代码实在调不通，所以先搁置。</p><h2 id="2-论文阅读"><a class="markdownIt-Anchor" href="#2-论文阅读"></a> 2. 论文阅读</h2><p>看了一篇论文Rotated Faster RCNN</p><p>感觉</p><h2 id="3-mmrotate框架"><a class="markdownIt-Anchor" href="#3-mmrotate框架"></a> 3. MMRotate框架</h2><p>前些天刷知乎，发现了一个4月份刚刚开源的旋转框检测框架。 基于Pytorch</p><p>MMRotate提供了目前旋转框检测任务最先进的算法模型，包括ReDet、 Oriented R-CNN等.</p><p>目前刚安装配置好环境，还没有实质性的进展。</p><p>后续打算边看文档学习该框架的使用，边写文章记录一些使用心得。</p>]]></content>
    
    
    <categories>
      
      <category>组会</category>
      
    </categories>
    
    
    <tags>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022-04-25-组会</title>
    <link href="/2022/04/24/Seminar/20220425-%E7%BB%84%E4%BC%9A/"/>
    <url>/2022/04/24/Seminar/20220425-%E7%BB%84%E4%BC%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="2022-04-25-组会"><a class="markdownIt-Anchor" href="#2022-04-25-组会"></a> 2022-04-25-组会</h1><h2 id="1redet"><a class="markdownIt-Anchor" href="#1redet"></a> 1.ReDet</h2><p>再细读了一遍ReDet，并回顾了ROI transformer，理解它的第二个创新点的实现过程。</p><p><a href="/2022/03/27/AI-Learning/20220328-ReDet" target="_blank">ReDet解读</a></p><h2 id="2代码"><a class="markdownIt-Anchor" href="#2代码"></a> 2.代码</h2><p>尝试了去修改文件格式，修改部分代码，修改路径,</p><p>仍然配置不成功，最好的结果是提示文件名过长</p><p><img src="/img/article/2022/04/25/1.png" alt="" /></p><p>注释中说</p><blockquote><p>detpath 是 result文件的路径</p><p>annopath 是 .xml文件的路径</p><p>imagesetfile 是图片文件路径</p></blockquote><p>但是按注释中配置还是会配置失败</p><p>我认为归根结底的原因还是因为作者没有给出配置样例，导致某个路径我设置错了，但我发现不了。</p><h2 id="3接下来的工作"><a class="markdownIt-Anchor" href="#3接下来的工作"></a> 3.接下来的工作</h2><p>我打算去看一些ReDet论文中提到的一些关键文章，如OBB,HBB,HTC 等，去补充一些旋转目标检测的基础理论。</p>]]></content>
    
    
    <categories>
      
      <category>组会</category>
      
    </categories>
    
    
    <tags>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022-04-18-组会</title>
    <link href="/2022/04/17/Seminar/20220418-%E7%BB%84%E4%BC%9A/"/>
    <url>/2022/04/17/Seminar/20220418-%E7%BB%84%E4%BC%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="2022-04-18-组会"><a class="markdownIt-Anchor" href="#2022-04-18-组会"></a> 2022-04-18-组会</h1><p>这两周毕业设计要提交很多材料，花费了很多时间来处理。</p><p>最近两天才有时间继续这边的实验研究。</p><h2 id="1邮箱"><a class="markdownIt-Anchor" href="#1邮箱"></a> 1.邮箱</h2><p>在4月2号晚上，我已经给ReDet的作者发送了电子邮件，询问评估Result的python文件中的路径该怎么配置。但是目前还没有收到回复。</p><h2 id="2reresnet"><a class="markdownIt-Anchor" href="#2reresnet"></a> 2.ReResNet</h2><p>也就是ReDet的backbone，作者在论文中基本没有提到这个backbone的具体实现。<br />我对比了ResNet和ReResNet的代码，查阅到了一些有用的资料，了解了其不同之处。</p><p>具体详情见<a href="/2022/03/27/AI-Learning/20220328-ReDet" target="_blank">ReDet解读</a></p>]]></content>
    
    
    <categories>
      
      <category>组会</category>
      
    </categories>
    
    
    <tags>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ReDet</title>
    <link href="/2022/03/27/AI-Learning/20220328-ReDet/"/>
    <url>/2022/03/27/AI-Learning/20220328-ReDet/</url>
    
    <content type="html"><![CDATA[<h1 id="redet"><a class="markdownIt-Anchor" href="#redet"></a> ReDet</h1><h2 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h2><p><strong>论文题目</strong> : ReDet: A Rotation-equivariant Detector for Aerial Object Detection</p><p><strong>论文地址</strong> : <a href="https://arxiv.org/pdf/1708.02002.pdf">https://arxiv.org/pdf/1708.02002.pdf</a></p><h2 id="idea"><a class="markdownIt-Anchor" href="#idea"></a> Idea</h2><p>提出了一种旋转等变检测器(ReDet)来从旋转等变特征中提取完全旋转不变的特征。</p><p><img src="/img/article/2022/03/27/1.png" alt="" /></p><p>如图，作者首先说明了普通CNN层对平移的不变性，但对旋转不具备不变性和等变性。作者采用了新的backbone【Reresnet，旋转不变主干网络，使用e2cnn重写Resnet】，能输出具有旋转等变性的特征图。同时特征图经过align后就不再具备旋转不变性了，所以作者也设计了一个特殊的align方法【RiRoI Align,除了普通RRoI Align具有的空间对齐(spatial alignment)，还多了一层方向对齐(orientation alignment)】,使得生成的特征图具备旋转不变性用以检测分类。</p><p>最后，旋转不变主干网络和RiRoI Align的结合形成了ReDet，以提取完全旋转不变的特征，从而实现精确的航空目标检测。</p><h2 id="network"><a class="markdownIt-Anchor" href="#network"></a> Network</h2><p><img src="/img/article/2022/03/27/2.png" alt="" /></p><p>Backbone: ResNet + FPN</p><p>改进–&gt; 添加了旋转等变</p><p>Rotation-equivariant Backbone:  ReResNet + ReFPN</p><p>紧接着采用RPN + RoI Transformer去生成RRoIs，然后再喂入到RiRoI Align 生成RoI feature， 最后再使用全连接层，然后到classification和bbox regression。</p><p>方向对齐: 循环切换方向通道并插值特征，以生成完全旋转不变的特征。</p><h2 id="detail"><a class="markdownIt-Anchor" href="#detail"></a> Detail</h2><h3 id="1backbonereresnet"><a class="markdownIt-Anchor" href="#1backbonereresnet"></a> 1.backbone【ReResNet】</h3><p>作者使用e2cnn，重写了mmdetction框架中的ResNet，形成了新的ReResNet，使其能输出具有旋转等变性的特征图。</p><p><img src="/img/article/2022/03/27/3.png" alt="" /></p><p>如图所示，在整体代码结构上，ReResNet相较于ResNet几乎没有变化。</p><p>作者在这里的主要工作，是使用开源的e2cnn库，重写了所有层(包括convolution, pooling, normalization, non-linearity等)，然后在代码中使用了这些层的地方全部做了替换。</p><p><img src="/img/article/2022/03/27/4.png" alt="" /></p><h3 id="2neckrefpn"><a class="markdownIt-Anchor" href="#2neckrefpn"></a> 2.neck【ReFPN】</h3><p>几乎与ReResNet如法炮制，同样使用e2cnn重写所有层。</p><p>但在ReFPN中多出了一个ConvModule，其e2cnn的部分都在这边引用，具体细节还在对比。</p><p><strong>e2cnn</strong></p><p>e2cnn全称:E(2)群等变可操控神经网络，于2019年提出，基于群等变卷积网络GroupEquivariant-CNN，给出了群表示如何改变特征图的概述，论述了群表示与非线性的兼容性。</p><p>论文地址：<a href="https://arxiv.org/pdf/1911.08251">https://arxiv.org/pdf/1911.08251</a></p><p>该作者给出了e2cnn的实现库，发布在github上：<a href="https://github.com/QUVA-Lab/e2cnn">https://github.com/QUVA-Lab/e2cnn</a></p><p>论文解读：<a href="https://blog.csdn.net/bxdzyhx/article/details/110521748">https://blog.csdn.net/bxdzyhx/article/details/110521748</a></p><p>这一部分论文偏理论，太过硬核，没看懂，需要抽象代数学得很好。。。<br />不过知道这个trick对旋转框很有用就行了。</p><h3 id="3roi-transformer"><a class="markdownIt-Anchor" href="#3roi-transformer"></a> 3.RoI transformer</h3><p><img src="/img/article/2022/03/27/9.png" alt="" /><br />原本的RT分为两部分，RRoI learner和RRoI warping。learner用来捕捉对旋转鲁棒的特征，warping相当于align部分。在本文中被拆开来用了。下图是RT的结构图：<br /><img src="/img/article/2022/03/27/5.png" alt="" /></p><h4 id="rroi-learner"><a class="markdownIt-Anchor" href="#rroi-learner"></a> RRoI learner</h4><p>在learner中，把RPN输出的HRoI当作输入，一次卷积后缩小至10channels，进入全连接层，输出一个5维向量(x,y,w,h,θ)，每个维度的GT(Groud Turth)值如下：<br /><img src="/img/article/2022/03/27/6.png" alt="" /><br />这里的五个值是RRoI GT和HRoI的偏移量，用这些偏移量作为输入进入decoder模块，解码出RRoI的相关参数，即(x,y,w,h,θ)。<br />这样可以使得最终的RRoI尽可能靠近gt值，这样即减少了参数量也提高了旋转框检测的性能。</p><h4 id="rroi-warpingrotation-invariant-roi-align"><a class="markdownIt-Anchor" href="#rroi-warpingrotation-invariant-roi-align"></a> RRoI warping(Rotation-invariant RoI Align)</h4><p>作者认为RoI warping已经可以捕捉旋转特征，但还无法使得生成的特征图具备旋转不变性，因此在RoI warping基础上添加了一个orientation alignment。同时为了保留位置信息，重新设计了特征图。</p><p><img src="/img/article/2022/03/27/7.png" alt="" /></p><p>本文的特征图维度为(k,n,h,w)，k是位置信息，n是方向channel数。</p><p>在orientation alignment中，特征图被分为n个方向的子特征图(一个channel一个方向)，根据对应的RoI的θ值,去进行该特征图的方向对齐，作者称这个过程叫switch channels。其过程如下：</p><p><img src="/img/article/2022/03/27/8.png" alt="" /></p><p>根据θ值计算一个下标r=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">⌊</mo><mfrac><mrow><mi>θ</mi><mo>∗</mo><mi>N</mi></mrow><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">\lfloor \frac{\theta*N}{2\pi}\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span>，r&lt;=1说明在N个方向内，r&gt;1说明在N个方向外。</p><p>如果θ值属于我们事先设定的N个方向中，则将<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>C</mi><mi>N</mi><mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">C_N^{(r)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.338331em;vertical-align:-0.29353099999999993em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4064690000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29353099999999993em;"><span></span></span></span></span></span></span></span></span></span>这个特征图与其他前一个orientation channel特征图循环交换，直到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>C</mi><mi>N</mi><mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">C_N^{(r)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.338331em;vertical-align:-0.29353099999999993em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4064690000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29353099999999993em;"><span></span></span></span></span></span></span></span></span></span>在第一位；如果θ值不属于N个方向，也就是说r需要向下取整，此时先交换至第一个特征图再通过线性插值的方法计算出该特征图的值。</p><p>【switch channels具体过程是这个样子，但是其原理没有弄懂，按文章中说应该是和e2cnn有很大关系】</p><blockquote><p>虽然目标检测方向的论文大体上都看过，了解一些目标检测Network架构，但感觉自己在遥感目标检测的一些专业术语知识还是太少了。</p><p>比如OBB, HBB,rotation-invariant features, RRoI Pooling ,RRoI Align，这篇文章还提到了 group convolutions（群卷积）也没接触过。</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RetinaNet</title>
    <link href="/2022/01/16/AI-Learning/20220117-RetinaNet/"/>
    <url>/2022/01/16/AI-Learning/20220117-RetinaNet/</url>
    
    <content type="html"><![CDATA[<h1 id="retinanet"><a class="markdownIt-Anchor" href="#retinanet"></a> RetinaNet</h1><h2 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h2><p><strong>论文题目</strong> : ReDet:A Rotation-equivariant Detector for Aerial Object Detection</p><p><strong>论文地址</strong> : <a href="https://arxiv.org/pdf/1708.02002.pdf">https://arxiv.org/pdf/1708.02002.pdf</a></p><p>Focal Loss用于解决类别不均衡问题，从而创造了RetinaNet（One Stage目标检测算法）这个精度超越经典Two Stage的Faster-RCNN的目标检测网络。</p><h2 id="idea"><a class="markdownIt-Anchor" href="#idea"></a> Idea</h2><p><img src="/img/article/2022/01/17/1.png" alt="" /></p><p>基于深度学习的目标检测算法有两类经典的结构：Two Stage 和 One Stage。</p><p><strong>Two Stage(1-2k)</strong>：例如Faster-RCNN算法。第一阶段专注于proposal的提取，第二阶段对提取出的proposal进行分类和精确坐标回归。两级结构准确度较高，但因为第二级需要单独对每个proposal进行分类/回归，速度上就打了折扣。</p><p><strong>One Stage(~100k)</strong>:  例如SSD，YOLO算法。此类算法摒弃了提取proposal的过程，只用一级就完成了识别/回归，虽然速度较快但准确率远远比不上两级结构。</p><p><strong>产生精度差异的主要原因：类别失衡（Class Imbalance）</strong>。One Stage方法在得到特征图后，会产生密集的目标候选区域，而这些大量的候选区域中只有很少一部分是真正的目标，这样就造成了机器学习中经典的训练样本正负不平衡的问题。它往往会造成最终算出的training loss为占绝对多数但包含信息量却很少的负样本所支配，少样正样本提供的关键信息却不能在一般所用的training loss中发挥正常作用，从而无法得出一个能对模型训练提供正确指导的loss（而Two Stage方法得到proposal后，其候选区域要远远小于One Stage产生的候选区域，因此不会产生严重的类别失衡问题）。该论文中提出了Focal Loss来降低类别失衡，对最终的Loss进行校正。</p><h2 id="network"><a class="markdownIt-Anchor" href="#network"></a> Network</h2><p><img src="/img/article/2022/01/17/2.png" alt="" /></p><p>RetinaNet的网络结构: ResNet + FPN +  FCN*2</p><p>输入图像经过Backbone的特征提取后，可以得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">{P_3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>~<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>7</mn></msub></mrow><annotation encoding="application/x-tex">{P_7}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>特征金字塔，对每层特征金字塔分别使用两个子网络（分类网络+检测框位置回归）。</p><p>子网络的设计类似于RPN，使用anchors来产生proposal。</p><p><strong>上面说到的Focal Loss就应用于类别分类的子网络</strong>，即可有效移植类别不均衡问题。</p><p>特征金字塔每层都相应的产生目标类别与位置的预测，最后再将其融合起来，同时使用NMS来得到最后的检测结果。</p><h3 id="focal-loss"><a class="markdownIt-Anchor" href="#focal-loss"></a> Focal Loss</h3><p>Focal Loss这个trick主要是在交叉熵损失函数做改进。</p><p>对于一般的二分类问题，其交叉熵损失函数如下:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>E</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>y</mi><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{CE(p,y) = L(y,p) = -ylog(p) - (1-y)log(1-p)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></span></p><p>可以写成:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>E</mi><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo stretchy="false">(</mo><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">CE= \begin{cases}  -\log_{}{(p)} &amp; \text{ if } y=1   \\  -\log_{}{(1-p)} &amp; \text{ if } y=-1(otherwise)\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>为了方便，定义<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{p_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>表示<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>，如下:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo stretchy="false">(</mo><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">p_t= \begin{cases}  p &amp; \text{ if } y=1   \\  1-p &amp; \text{ if } y=-1(otherwise)\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>这样CE就可以表示成如下表达式:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>E</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>C</mi><mi>E</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow></mrow><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">CE(p,y) = CE(p_t) = -\log{}{p_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>pt可以看作样本被正确分类的一个概率值。</p><p>可以认为当模型预测得到的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub><mo>&gt;</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">P_t &gt; 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span>的样本为easy examples ; 而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">P_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>值预测较小的样本为hard examples。</p><h4 id="postivenegative-example"><a class="markdownIt-Anchor" href="#postivenegative-example"></a> Postive/Negative example</h4><p>解决class imbalance的一个方法是为类1添加一个权重因子α ∈ [0, 1]，对于y =1的使用权重 α ，对y =-1使用 1-α；这样就能一定程度上的解决了正负样本的不平衡。</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>E</mi><mo>=</mo><mo>−</mo><mi>α</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>α</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo stretchy="false">(</mo><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">CE= -\alpha \log_{}{p_t}= \begin{cases}  -\alpha \log_{}{(p)} &amp; \text{ if } y=1   \\  -(1-\alpha)\log_{}{(1-p)} &amp; \text{ if } y=-1(otherwise)\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><h4 id="easyhard-example"><a class="markdownIt-Anchor" href="#easyhard-example"></a> Easy/Hard example</h4><p>因为hard examples通常为少数样本，所以虽然其对应的loss值较高，但是最后全部累加后，大部分的loss值来自于容易分类的样本，这样在模型优化的过程中就会将更多的优化放到容易分类的样本中，而忽略hard examples。因此论文中引入调节因子<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mi>γ</mi></msup></mrow><annotation encoding="application/x-tex">(1-p_t)^{\gamma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>E</mi><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mi>γ</mi></msup><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mi>γ</mi></msup><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msup><mi>p</mi><mi>γ</mi></msup><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo stretchy="false">(</mo><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">CE= -(1-p_t)^{\gamma} \log_{}{p_t}= \begin{cases}  -(1-p)^{\gamma} \log_{}{(p)} &amp; \text{ if } y=1   \\  -p^{\gamma}\log_{}{(1-p)} &amp; \text{ if } y=-1(otherwise)\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">P_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>较大时为Easy example，此时调制因子接近0, 降低了Loss累加中Easy example的权重;</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">P_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>较小时为Hard example，此时调制因子接近1, 增加了Loss累加中Easy example的权重。</p><p>通过实验测试，超参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">y = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>效果最好。</p><p><img src="/img/article/2022/01/17/3.png" alt="" /></p><hr /><p>将上述两种权重因子整合起来，就是最终的Focal Loss:</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>E</mi><mo>=</mo><mo>−</mo><mi>α</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mi>γ</mi></msup><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>α</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mi>γ</mi></msup><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><msup><mi>p</mi><mi>γ</mi></msup><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow></mrow></msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>y</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo stretchy="false">(</mo><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">CE= -\alpha(1-p_t)^{\gamma} \log_{}{p_t}= \begin{cases}  -\alpha(1-p)^{\gamma} \log_{}{(p)} &amp; \text{ if } y=1   \\  -(1-\alpha)p^{\gamma}\log_{}{(1-p)} &amp; \text{ if } y=-1(otherwise)\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.24414em;"><span style="top:-1.75586em;margin-right:0.05em;"><span class="pstrut" style="height:2em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>下图是论文中给出的试验结果，相比较于经典的Two Stage检测方法Faster-RCNN，RetinaNet具有更高的精度。</p><p><img src="/img/article/2022/01/17/4.png" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ROI Transformer</title>
    <link href="/2021/12/12/AI-Learning/20211212-ROI%20Transformer/"/>
    <url>/2021/12/12/AI-Learning/20211212-ROI%20Transformer/</url>
    
    <content type="html"><![CDATA[<h1 id="roi-transformer"><a class="markdownIt-Anchor" href="#roi-transformer"></a> ROI Transformer</h1><h2 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h2><ul><li><strong>论文题目</strong> : Learning RoI Transformer for Oriented Object Detection in Aerial Images</li><li><strong>论文作者</strong> : Jian Ding, Nan Xue, Yang Long, Gui-Song Xia∗ , Qikai Lu – LIESMARS-CAPTAIN, Wuhan University</li><li><strong>论文地址</strong> : <a href="https://openaccess.thecvf.com/content_CVPR_2019/html/Ding_Learning_RoI_Transformer_for_Oriented_Object_Detection_in_Aerial_Images_CVPR_2019_paper">CVPR_2019-ROI Transformer</a></li><li><strong>代码实现</strong> : <a href="https://github.com/dingjiansw101/AerialDetection">https://github.com/dingjiansw101/AerialDetection</a></li></ul><p>鸟瞰视角、高度复杂的背景、目标外形的剧烈变化使得航拍图像目标检测成为难题。尤其当航拍图像中目标密集存在时，常规目标检测中的水平proposals（HRoIs）与目标之间的不匹配将进一步影响分类和定位。本文中作者提出了[<strong>RoI Transformer</strong>]方法来解决这一问题，基于两阶段框架，通过基于位置敏感对齐的监督RRoI学习和特征提取，实现定向和密集对象的检测。</p><p><img src="/img/article/2021/12/12/1.png" alt="" /></p><p>水平RoI通常包含多个实例，而旋转RoI通常更加精确。</p><p>RoI Transformer是轻量级的且可以很容易的嵌入各种旋转目标检测器中。</p><h2 id="idea"><a class="markdownIt-Anchor" href="#idea"></a> Idea</h2><p>本文中作者提出的ROI Transformer 由两部分组成:</p><ul><li><p><strong>第一部分是RRoI Learner，它学习从HRoIs到RRoIs的转换；</strong></p></li><li><p><strong>第二部分是RRoI Warping，它从RRoI中提取旋转不变的特征，用于后续的分类和回归子任务</strong>。</p></li><li><p>HRoIs(horizontal RoIs):水平候选框</p></li><li><p>RRoIs(Rotated RoIs):   旋转候选框</p></li><li><p>RGTs(Rotated Ground Truths): 预先标注的旋转真实框</p></li></ul><h2 id="details"><a class="markdownIt-Anchor" href="#details"></a> Details</h2><h3 id="rroi-learner"><a class="markdownIt-Anchor" href="#rroi-learner"></a> RRoI Learner</h3><p><img src="/img/article/2021/12/12/2.png" alt="" /></p><p>PS RoI Align(Position Sensitive RoI Alignment) [位置敏感的候选区域]</p><blockquote><p>这个概念涉及到一篇以前的论文R-FCN，其主要思想是在特征聚集时 <strong>人工引入位置信息</strong> ，从而有效改善较深的神经网络对物体位置信息的敏感程度</p><p>PS-ROI Align 对模型的检测性能有提升，对小物体的感知能力有明显改善</p></blockquote><p>这个网络将HRoIs 作为输入传给RRoI Learner，</p><p>FC-5: 后面跟着一个5维的全连接层，该全连接层用于回归RGTs相对于HRoIs的偏移量。</p><p>DeCoder: 解码器，将HRoIs和偏移量作为输入，输出RRoI</p><p>后续将Featrue map和RRoIs传递给RRoI Warping，用于几何鲁棒特征提取。</p><h3 id="rroi-warping"><a class="markdownIt-Anchor" href="#rroi-warping"></a> RRoI Warping</h3><p>RRoI Warping通过RRoI的参数提取旋转不变的深度特征（其实就是用Rotated Position Sensitive RoI pooling实现旋转版的池化）。</p><p><img src="/img/article/2021/12/12/4.png" alt="" /></p><p>因为采用Light-Head R-CNN，这里RRoI Warping具体使用Rotated Position Sensitive (RPS) RoI Align。</p><p><img src="/img/article/2021/12/12/5.png" alt="" /></p><p>给定具有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo>×</mo><mi>W</mi><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">H × W × C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>通道的输入特征图  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span></span> 和 RRoI <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>w</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>h</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>θ</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_r,y_r,w_r,h_r,θ_r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>RPS RoI pooling 将旋转的 Rotated RoI 分成<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>×</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">K × K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> bin，并输出形状为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>×</mo><mi>K</mi><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">K × K × C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> 的特征图 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">\mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">Y</span></span></span></span></span>。</p><ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span></span>是输入的feature map</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">T_θ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是RRoIs</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">\mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">Y</span></span></span></span></span>是输出的feature map</li><li>bin 是池化的一小块， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>是每一块bin的样本参数量</li></ul><p>对于每个bin的(x,y)，通过以下式子转换为(x’,y’):</p><p><img src="/img/article/2021/12/12/6.png" alt="" /></p><h3 id="iou的计算"><a class="markdownIt-Anchor" href="#iou的计算"></a> IOU的计算</h3><p><img src="/img/article/2021/12/12/7.jpg" alt="" /></p><p>计算RRoI 和匹配的 RGT 之间的 IoU，也是不规则多边形的IOU，作者在文章中没有提及计算方法。</p><p>对于长而窄的边界框，角度的轻微抖动可能导致两个盒子的 IoU 非常低，因此阈值取0.5.</p>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>YOLOv2v3</title>
    <link href="/2021/11/27/AI-Learning/20211128-YOLOv2v3/"/>
    <url>/2021/11/27/AI-Learning/20211128-YOLOv2v3/</url>
    
    <content type="html"><![CDATA[<h1 id="yolo-v2v3"><a class="markdownIt-Anchor" href="#yolo-v2v3"></a> YOLO v2v3</h1><p>YOLOv1的缺陷:</p><ol><li><p>虽然速度快，但是准确度比较低</p></li><li><p>定位性能比较差，相对于FastRCNN来说，是就调整检测框的能力较差</p></li><li><p>ReCall比较低，(把全部目标检出的能力较差)YOLOv1把图像划分成7*7个Grid Cell，每个GridCell 预测两个BBox，最多有98个BBox，如果图像中目标很多，就很难把所有目标检测出来，所以ReCall比较低</p></li><li><p>7*7个Grid Cell 每个GridCell只能负责预测一个物体，所以最多检测出49个物体，因此检测小目标和密集目标也很差</p></li></ol><p>Better:</p><ul><li>Batch Normalization</li></ul><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">归</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">化</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">输</mi><mi mathvariant="normal">出</mi><mo>−</mo><mi mathvariant="normal">输</mi><mi mathvariant="normal">出</mi><mi mathvariant="normal">均</mi><mi mathvariant="normal">值</mi></mrow><mrow><mi mathvariant="normal">标</mi><mi mathvariant="normal">准</mi><mi mathvariant="normal">差</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">归一化 = {\frac{输出- 输出均值}{标准差}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mord cjk_fallback">归</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">化</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1473309999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.802331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">标</span><span class="mord cjk_fallback mtight">准</span><span class="mord cjk_fallback mtight">差</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">输</span><span class="mord cjk_fallback mtight">出</span><span class="mbin mtight">−</span><span class="mord cjk_fallback mtight">输</span><span class="mord cjk_fallback mtight">出</span><span class="mord cjk_fallback mtight">均</span><span class="mord cjk_fallback mtight">值</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><ul><li>High Resolution Classifier (高分辨率的分类器)</li><li>Anchor</li><li>Dimension Cluster</li><li>Direct location prediction(直接定位)</li><li>Fine-Grained Features (细粒度特征)</li><li>Multi-Scale Training(多尺度训练)</li></ul>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>YOLOv1</title>
    <link href="/2021/11/21/AI-Learning/20211121-YOLOv1/"/>
    <url>/2021/11/21/AI-Learning/20211121-YOLOv1/</url>
    
    <content type="html"><![CDATA[<h1 id="yolov1"><a class="markdownIt-Anchor" href="#yolov1"></a> YOLOv1</h1><h2 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h2><ul><li><strong>论文题目</strong> : You Only Look Once: Unified, Real-Time Object Detection</li><li><strong>论文地址</strong> : <a href="https://arxiv.org/pdf/1506.02640.pdf">https://arxiv.org/pdf/1506.02640.pdf</a><br />YOLO将物体检测作为回归问题求解。基于一个单独的end-to-end网络，完成从原始图像的输入到物体位置和类别输出。</li></ul><h2 id="idea"><a class="markdownIt-Anchor" href="#idea"></a> Idea</h2><p>[1] YOLO训练和检测均是在一个单独网络中进行。YOLO没有显示地求取region proposal的过程。而rcnn/fast rcnn 采用分离的模块）求取候选框（可能会包含物体的矩形区域），训练过程因此也是分成多个模块进行。</p><p>[2]YOLO将物体检测作为一个回归问题进行求解，输入图像经过一次inference，便能得到图像中所有物体的位置和其所属类别及相应的置信概率。</p><h2 id="network"><a class="markdownIt-Anchor" href="#network"></a> NetWork</h2><p><img src="/img/article/2021/11/21/1.png" alt="" /></p><h3 id="predicting"><a class="markdownIt-Anchor" href="#predicting"></a> Predicting</h3><p><img src="/img/article/2021/11/21/13.png" alt="" /></p><p><img src="/img/article/2021/11/21/2.png" alt="" /></p><p><strong>PPT演示</strong> : <a href="https://docs.google.com/presentation/d/1aeRvtKG21KHdD5lg6Hgyhx5rPq_ZOsGjG5rJ1HP7BbA/pub?start=false&amp;loop=false&amp;delayms=3000&amp;slide=id.p">地址</a></p><p>把448x448x3的输入图像，进行编码、压缩、处理，经过卷积层，全连接层，最后得到一个7x7x30的张量。</p><p>7x7对应的是7x7个Grid Cell，30维由5(第一个BBox参数)、5(第一个BBox参数)、20(假设在该GridCell的条件下，对应的20个类别概率)构成。</p><p>全概率=条件本身发生的概率[置信度,Grid Cell在该BBox包含物体的概率]x条件概率[该条件下，20个类别概率]</p><p>使用NMS[非极大值抑制]把低置信度和重复的框过滤掉，只保留一个，最终获得目标检测的结果。</p><h3 id="training"><a class="markdownIt-Anchor" href="#training"></a> Training</h3><p>深度学习的训练是通过梯度下降和反向传播方法，去迭代更新神经元的权重，来使得Loss函数最小化的过程。</p><p><img src="/img/article/2021/11/21/10.png" alt="" /></p><p>人工标注数据Ground Truth，这个Ground Truth的中心点落在哪个Grid Cell里，就应该由哪个Grid Cell预测出的BBox负责拟合这个Ground Truth。</p><p><img src="/img/article/2021/11/21/11.png" alt="" /></p><p>之前也说到每个Grid Cell预测两个BBox，然后分别计算IOU，选择IOU较大的BBox来负责拟合该Ground Truth，让该BBox最终尽可能逼近Ground Truth。</p><p><img src="/img/article/2021/11/21/12.png" alt="" /></p><p>接下来看损失函数:</p><p><img src="/img/article/2021/11/21/14.png" alt="" /></p><p>遍历所有Grid Cell中的所有BBox，采用平方和误差。</p><ul><li>整体分为五个部分，负责检测的BBox的中心点误差、负责检测的BBox的宽高误差、负责检测的BBox的Confidence误差、不负责检测的BBox的Confidence误差、负责检测物体的Grid Cell的分类误差。</li><li>对于负责检测的BBox的宽高误差，采用求根号能使小框对误差更敏感</li><li>给予负责检测物体的BBox更高的权重：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>λ</mi><mrow><mi>c</mi><mi>o</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\lambda _{coord} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>  ，给予不负责检测物体的BBox较低的权重：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>λ</mi><mrow><mi>n</mi><mi>o</mi><mi>o</mi><mi>b</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\lambda _{noobj}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></li></ul>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>R-CNN系列目标检测模型</title>
    <link href="/2021/11/14/AI-Learning/20211114-R-CNN%E7%B3%BB%E5%88%97%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E6%A8%A1%E5%9E%8B/"/>
    <url>/2021/11/14/AI-Learning/20211114-R-CNN%E7%B3%BB%E5%88%97%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="r-cnn-fast-r-cnn-faster-r-cnn"><a class="markdownIt-Anchor" href="#r-cnn-fast-r-cnn-faster-r-cnn"></a> R-CNN、Fast R-CNN、Faster R-CNN</h1><h2 id="1-r-cnn"><a class="markdownIt-Anchor" href="#1-r-cnn"></a> 1 R-CNN</h2><h3 id="11-introduction"><a class="markdownIt-Anchor" href="#11-introduction"></a> 1.1 Introduction</h3><ul><li><strong>论文题目</strong> : Rich feature hierarchies for accurate object detection and semantic segmentation</li><li><strong>论文地址</strong> : <a href="https://arxiv.org/abs/1311.2524v3">https://arxiv.org/abs/1311.2524v3</a></li></ul><p>R-CNN（Region CNN，区域卷积神经网络）可以说是利用深度学习进行目标检测的开山之作。</p><h3 id="12-idea"><a class="markdownIt-Anchor" href="#12-idea"></a> 1.2 Idea</h3><ul><li>经典的目标检测算法使用滑动窗法依次判断所有可能的区域。作者则(采用Selective Search方法)预先提取一系列较可能是物体的候选区域。</li><li>经典的目标检测算法在区域中提取人工设定的特征。作者则采用深度网络(CNN)进行特征提取。</li></ul><h3 id="13-network"><a class="markdownIt-Anchor" href="#13-network"></a> 1.3 Network</h3><p><img src="/img/article/2021/11/14/1.png" alt="R-CNN网络结构" /></p><p><strong>Step1</strong> :输入图像<br /><strong>Step2</strong> :每张图像生成1K~2K个候选区域<br /><strong>Step3</strong> :对每个候选区域，使用卷积网络(如VGG16)提取特征<br /><strong>Step4</strong> :将特征送入每一类的SVM分类器，判别是否属于该类; 使用回归器精细修正候选框位置</p><h3 id="14-detail"><a class="markdownIt-Anchor" href="#14-detail"></a> 1.4 Detail</h3><h4 id="region-proposal"><a class="markdownIt-Anchor" href="#region-proposal"></a> Region Proposal</h4><p>对应上述Step2</p><p>作者使用Selective Search（选择性搜索）生成候选区域，Selective Search的实现思路如下:</p><blockquote><p>（1）使用一种过分割手段，将图像分割成小区域</p><p>（2）查看现有小区域，合并可能性最高的两个区域，重复直到整张图像合并成一个区域位置。优先合并以下区域：</p><ul><li>颜色（颜色直方图）相近的</li><li>纹理（梯度直方图）相近的</li><li>合并后总面积小的</li><li>合并后，总面积在其BBOX中所占比例大的<br />在合并时须保证合并操作的尺度较为均匀，避免一个大区域陆续“吃掉”其它小区域，保证合并后形状规则。</li></ul><p>（3）输出所有曾经存在过的区域，即所谓候选区域</p></blockquote><p>具体算法可以看原论文<a href="https://ivi.fnwi.uva.nl/isis/publications/2013/UijlingsIJCV2013/UijlingsIJCV2013.pdf">《Selective Search for Object Recognition》</a></p><h4 id="feature-extraction"><a class="markdownIt-Anchor" href="#feature-extraction"></a> Feature Extraction</h4><p>对应上述Step3</p><p>使用深度网络提取特征之前，首先把候选区域归一化成同一尺寸227×227。</p><p>作者使用CNN网络进行训练，第一选择经典的Alexnet；第二选择VGG16。(经测试Alexnet精度为58.5%，VGG16精度为66%)</p><p>通过CNN网络训练完毕后，最后提取特征每个输入候选框图片都能得到一个4096维的特征向量。</p><h4 id="classification-and-regression"><a class="markdownIt-Anchor" href="#classification-and-regression"></a> Classification and Regression</h4><p>分类，作者使用的是SVM分类器</p><p>作者测试了IOU阈值各种方案数值0.1,0.2,0.3,0.4,0.5。最后通过训练发现，如果选择IOU阈值为0.3效果最好（选择为0精度下降了4个百分点，选择0.5精度下降了5个百分点）,即当重叠度小于0.3的时候，把它标注为负样本。</p><p>我们将为每个物体类训练一个SVM分类器。当我们用CNN提取2000个候选框，可以得到[2000x4096]这样的特征向量矩阵，然后我们只需要把这样的一个矩阵与svm权值矩阵4096xN点乘(N为分类类别数目，因为我们训练的N个SVM，每个SVM包含了4096个权值w)，就可以得到分类结果了。</p><p>边界回归，也就是Bounding-box regression。</p><p><img src="/img/article/2021/11/14/2.png" alt="" /></p><p><img src="/img/article/2021/11/14/3.png" alt="" /></p><p><img src="/img/article/2021/11/14/4.png" alt="" /></p><h2 id="2-fast-r-cnn"><a class="markdownIt-Anchor" href="#2-fast-r-cnn"></a> 2 Fast R-CNN</h2><h3 id="21-introduction"><a class="markdownIt-Anchor" href="#21-introduction"></a> 2.1 Introduction</h3><ul><li><strong>论文题目</strong> : Fast R-CNN</li><li><strong>论文地址</strong> : <a href="https://arxiv.org/abs/1504.08083">https://arxiv.org/abs/1504.08083</a></li></ul><p>继2014年的R-CNN推出之后，作者在2015年推出Fast R-CNN，其流程更为紧凑，大幅提升了目标检测的速度。Fast R-CNN和R-CNN相比，训练时间从84小时减少到9.5小时，测试时间从47秒减少到0.32秒，并且在PASCAL VOC 2007上测试的准确率相差无几，约在66%-67%之间。</p><h3 id="22-idea"><a class="markdownIt-Anchor" href="#22-idea"></a> 2.2 Idea</h3><p>与前作相比，Fast R-CNN解决了以下问题:</p><p>1、训练、测试时速度慢<br />R-CNN的一张图像内候选框之间存在大量重叠，提取特征操作冗余。而Fast R-CNN将整张图像归一化后直接送入深度网络，紧接着送入从这幅图像上提取出的候选区域。这些候选区域的前几层特征不需要再重复计算。<br />2、训练所需空间大<br />R-CNN中独立的SVM分类器和回归器需要大量特征作为训练样本。Fast R-CNN把类别判断和位置精调统一用深度网络实现，不再需要额外存储。</p><h3 id="23network"><a class="markdownIt-Anchor" href="#23network"></a> 2.3Network</h3><p><img src="/img/article/2021/11/14/5.png" alt="" /></p><p><strong>Step1</strong> :首先将整个图片输入到一个卷积网络，得到整张图的feature map，然后将region proposal（RoI）映射到feature map的对应位置。</p><p><strong>Step2</strong> :RoI pooling layer提取一个__固定长度__的特征向量，每个特征会输入到一系列全连接层，得到一个RoI特征向量</p><p><strong>Step3</strong> :建立softmax层进行分类，建立bounding box regressor回归边界，二者合并为多目标损失函数任务。</p><h3 id="24-detail"><a class="markdownIt-Anchor" href="#24-detail"></a> 2.4 Detail</h3><h4 id="feature-extraction-2"><a class="markdownIt-Anchor" href="#feature-extraction-2"></a> Feature Extraction</h4><p>对应上述Step2</p><p>在Fast R-CNN中，作者提出了一个叫做ROI Pooling的网络层，这个网络层可以把不同大小的输入[Region Proposal]映射到一个固定尺度的特征向量。</p><p><img src="/img/article/2021/11/14/6.png" alt="" /></p><p>在文章当中，作者使用H=W=7的超参数作为ROI Pooling输出的特征向量的固定尺度。即将一个<code>h*w</code>的region proposal分割成<code>H*W</code>大小的网格，作为最后一层卷积层，然后分别对每个网格的进行Max Pooling，将特征图上大小不一的region proposal转变为大小统一的<code>H*W</code>矩阵。</p><p><strong>意义</strong> :因为全连接层的输入要求尺寸大小一样，所以不能直接将不同大小的region proposal映射到feature map作为输出，需要做尺寸变换。这个时候在全连接层前加一层ROI Pooling可以解决该问题。</p><h4 id="classification-and-regression-2"><a class="markdownIt-Anchor" href="#classification-and-regression-2"></a> Classification and Regression</h4><p>对应上述Step3</p><p><img src="/img/article/2021/11/14/7.png" alt="" /></p><p>在R-CNN中，先生成候选框，然后再通过CNN提取特征，之后再用SVM分类，最后再做回归得到具体位置（bbox regression）。</p><p>而在Fast R-CNN中，作者把最后的bbox regression也放进了神经网络内部，与区域分类合并成为了一个multi-task模型。</p><p><strong>分类loss</strong>：使用一个N+1路的softmax代替原来的SVM分类器，其中的N是类别个数，1是背景，使用交叉熵损失<br /><strong>回归loss</strong>：一个4xN路输出的regressor，也就是说对于每个类别都会训练一个单独的regressor，使用平均绝对误差（MAE）损失</p><p><img src="/img/article/2021/11/14/8.png" alt="" /></p><h2 id="3-faster-r-cnn"><a class="markdownIt-Anchor" href="#3-faster-r-cnn"></a> 3 Faster R-CNN</h2><h3 id="31-introduction"><a class="markdownIt-Anchor" href="#31-introduction"></a> 3.1 Introduction</h3><ul><li><strong>论文题目</strong> : Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks</li><li><strong>论文地址</strong> : <a href="https://arxiv.org/abs/1506.01497">https://arxiv.org/abs/1506.01497</a></li></ul><h3 id="32-idea"><a class="markdownIt-Anchor" href="#32-idea"></a> 3.2 Idea</h3><p>与前作相比:</p><p>Faster R-CNN设计了提取候选区域的网络RPN，代替了费时的Selective Search（选择性搜索），已经将Feature Extraction、</p><p>region proposal、Classification、Bounding-Box regression(rect refine)都整合在了一个网络中，使得综合性能有较大提高</p><p><img src="/img/article/2021/11/14/11.png" alt="" /></p><h3 id="33-network"><a class="markdownIt-Anchor" href="#33-network"></a> 3.3 Network</h3><p><img src="/img/article/2021/11/14/9.png" alt="" /></p><p><strong>Step1</strong> :Conv layers。作为一种CNN网络目标检测方法，Faster RCNN首先使用一组基础的conv+relu+pooling层提取image的feature maps。该feature maps被共享用于后续RPN层和全连接层。</p><p><strong>Step2</strong> :Region Proposal Networks。RPN网络用于生成region proposals。该层通过softmax判断anchors属于positive或者negative，再利用bounding box regression修正anchors获得精确的proposals。</p><p><strong>Step3</strong> :RoI Pooling。该层收集输入的feature maps和proposals，综合这些信息后提取proposal feature maps，送入后续全连接层判定目标类别。</p><p><strong>Step4</strong> :Classification。利用proposal feature maps计算proposal的类别，同时再次bounding box regression获得检测框最终的精确位置。</p><h3 id="34-detail"><a class="markdownIt-Anchor" href="#34-detail"></a> 3.4 Detail</h3><h4 id="rpn"><a class="markdownIt-Anchor" href="#rpn"></a> RPN</h4><p><img src="/img/article/2021/11/14/12.jpg" alt="" /></p><p>上图展示了RPN网络的具体结构。可以看到RPN网络实际分为2条线:</p><p>上面一条通过softmax分类anchors获得positive和negative分类，</p><p>下面一条用于计算对于anchors的bounding box regression偏移量，以获得精确的proposal。</p><p>而最后的Proposal层则负责综合positive anchors和对应bounding box regression偏移量获取proposals，同时剔除太小和超出边界的proposals。其实整个网络到了Proposal Layer这里，就完成了相当于目标定位的功能。</p><blockquote><p>Todo :</p><ol><li>关于Selective Search、RPN、Bounding-Box regression的详细实现原理，还是要看看具体代码才能更清晰。</li></ol></blockquote>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>旋转目标检测(一)-RRPN</title>
    <link href="/2021/10/30/AI-Learning/20211030-%E6%97%8B%E8%BD%AC%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B(%E4%B8%80)-RRPN/"/>
    <url>/2021/10/30/AI-Learning/20211030-%E6%97%8B%E8%BD%AC%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B(%E4%B8%80)-RRPN/</url>
    
    <content type="html"><![CDATA[<h1 id="旋转目标检测一-rrpn"><a class="markdownIt-Anchor" href="#旋转目标检测一-rrpn"></a> 旋转目标检测(一)-RRPN</h1><h2 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h2><ul><li><strong>论文题目</strong> : Arbitrary-Oriented Scene Text Detection via Rotation Proposals</li><li><strong>论文地址</strong> : <a href="https://arxiv.org/abs/1703.01086">https://arxiv.org/abs/1703.01086</a></li><li><strong>代码实现</strong> : <a href="https://github.com/mjq11302010044/RRPN">https://github.com/mjq11302010044/RRPN</a></li></ul><p><img src="/img/article/2021/10/30/introduce.png" alt="" /></p><p>自然场景文本检测存在的困难：光照不均，模糊，透视畸变，文本不定向等等</p><p>前人提出的使用分段网络（如完全卷积网络[FCN])生成文本预测图，需要几个后处理步骤来生成具有所需方向的最终文本区域建议，通常非常耗时。</p><p>作者提出了基于旋转候选框实现任意方向的场景文本检测，简称RRPN，其思想沿用的是目标检测中的RPN，在其基础上增加了旋转角度信息。最后在三个数据集(MSRA-TD500, ICDAR2013,ICDAR2015)进行了测试，发现它比以前的方法准确而且更有效。</p><h2 id="idea"><a class="markdownIt-Anchor" href="#idea"></a> Idea</h2><ul><li>与先前基于分割的框架不同，作者提出了基于候选框的不定向文本检测，使得候选框可以更好地适应文本区域，可以更好地修正长文本区域</li><li>作者将新提出的RROI池化层和旋转候选框的学习加入到基于候选框区域的结构当中，与传统的基于分割的文本检测框架相比，确保了文本检测的计算效率</li><li>作者提出了任意方向选择候选框的新的修正方法(refinement)，以提高任意文本检测的性能。</li></ul><h2 id="实现"><a class="markdownIt-Anchor" href="#实现"></a> 实现</h2><h3 id="网络结构-rrpn框架"><a class="markdownIt-Anchor" href="#网络结构-rrpn框架"></a> 网络结构-RRPN框架</h3><p><img src="/img/article/2021/10/30/Network.png" alt="RRPN网络结构" /></p><p>RRPN沿用了Faster-RCNN中的RPN的思想(即使用其来生成候选区域)，并在此基础上进行了改进，提出了基于旋转候选网络区域(RRPN)．整个网络结构和Faster-RCNN非常相似，RRPN也是分成并行两路：一路用于预测类别，另一路用于回归旋转矩形框。</p><p>具体步骤如下:</p><ol><li>前端使用非常经典的 <strong>VGG16</strong> 作为主干特征提取网络</li><li>中间采用RRPN主要是用于生成带倾斜角的候选区域，该层输出包括候选框的类别和旋转矩形框的回归</li><li>通过RRoI Pooling将RRPN生成的候选框映射到特征图上，得到最终的文本行检测结果</li></ol><h3 id="具体细节"><a class="markdownIt-Anchor" href="#具体细节"></a> 具体细节</h3><h4 id="1rotated-bounding-box-representation-旋转矩形框的表示"><a class="markdownIt-Anchor" href="#1rotated-bounding-box-representation-旋转矩形框的表示"></a> 1.Rotated Bounding Box Representation-旋转矩形框的表示</h4><p>用(x,y,w,h,θ)表示旋转矩形框：其中(x,y)表示几何矩形中心点坐标,h表示矩形框的短边长度,w 表示矩形框的长边,θ表示x正轴与矩形框长边的夹角。</p><p>围绕矩阵中心旋转α角后，中心锚点坐标公式:</p><p><img src="/img/article/2021/10/30/1.png" alt="" /></p><p>其中 <strong>T</strong> 是平移矩阵, <strong>R</strong> 是旋转矩阵。</p><p><img src="/img/article/2021/10/30/2.png" alt="" /></p><h4 id="2rotation-anchors-strategy-锚点旋转策略"><a class="markdownIt-Anchor" href="#2rotation-anchors-strategy-锚点旋转策略"></a> 2.Rotation Anchors Strategy-锚点旋转策略</h4><p>Anchors 就是按照固定比例（长宽、大小）预定义的框，在后续阶段找出Bounding-box位置和大小，是以这些框为基础。</p><p><img src="/img/article/2021/10/30/3.png" alt="" /></p><p>作者提出的锚点R-anchor有三类策略：</p><ul><li>scale 有8，16，32三种，表示文本行的大小</li><li>ratio 有1：2，1：5，1：8三种，表示文本行的宽高比</li><li>angle 有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mo>−</mo><mi>π</mi></mrow><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{-\pi}{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1473309999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.802331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>π</mi><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{\pi}{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>π</mi><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{\pi}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{\pi}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mn>2</mn><mi>π</mi></mrow><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{2\pi}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>六种，表示提议框的旋转角</li></ul><p>综上所述，特征图上每个点将生成54个R-anchor（６个方向，３个尺度，３个宽高比）</p><h4 id="3learning-of-rotated-proposal-旋转矩形候选框的学习"><a class="markdownIt-Anchor" href="#3learning-of-rotated-proposal-旋转矩形候选框的学习"></a> 3.Learning of Rotated Proposal-旋转矩形候选框的学习</h4><p>RRPN层会生成很对很多的旋转矩形框，那么这些矩形框中有哪些是需要送入网络参与训练呢？</p><p>首先作者提出了如何确定它们当中用于作为训练的正、负样本的标准:</p><ul><li>训练正样本</li></ul><blockquote><p>需要同时满足以下两种条件:</p><p>1.其与ground truth的IOU大于0.7<br />2.其与ground truth的夹角小于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>π</mi><mn>12</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{\pi}{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p></blockquote><ul><li>训练负样本</li></ul><blockquote><p>满足以下条件之一:</p><p>1.其与ground truth的IOU小于0.3<br />2.其与ground truth的IOU大于0.7，并且与ground truth的夹角大于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>π</mi><mn>12</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{\pi}{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p></blockquote><ul><li>损失函数</li></ul><p>作者采用的是多任务损失函数，总公式如下:</p><p><img src="/img/article/2021/10/30/4.png" alt="" /></p><p>其中分类损失函数L<sub>cls</sub>:<img src="/img/article/2021/10/30/5.png" alt="" /></p><p>其中回归损失函数L<sub>reg</sub>:<img src="/img/article/2021/10/30/6.png" alt="" /></p><h4 id="4proposal-refinement候选框修正"><a class="markdownIt-Anchor" href="#4proposal-refinement候选框修正"></a> 4.Proposal Refinement–候选框修正</h4><p><strong>倾斜IOU的计算</strong></p><p>作者使用的是倾斜的候选框，所以基于水平候选框的IOU计算方法不合适，因此提出了倾斜IOU的计算方法</p><p><img src="/img/article/2021/10/30/7.png" alt="" /></p><p>总体思路：将两个矩形的交点进行顺时针排序并连成多边形，然后分割成一个个小三角形计算总面积。</p><p>以下图（b）举例子，多边形顺序AIJCKL，分割成三角形AIJ,AJC,ACK,AKL,计算这四个三角形的和。</p><p><img src="/img/article/2021/10/30/8.png" alt="" /></p><p><strong>RROI pooling</strong></p><p>针对任意方向的文本，作者提出了旋转ROI池化层．</p><p>将高度为h和宽度为w的旋转候选区域平均划分,每个子区域和候选框的方向相同．具体的实现细节如下</p><p><img src="/img/article/2021/10/30/9.png" alt="" /></p><h2 id="实验结果"><a class="markdownIt-Anchor" href="#实验结果"></a> 实验结果</h2><p>作者最后在三个数据集(MSRA-TD500, ICDAR2013,ICDAR2015)进行了测试，发现它比以前的方法准确而且更有效。</p><p><img src="/img/article/2021/10/30/12.png" alt="" /></p><h2 id="知识索引"><a class="markdownIt-Anchor" href="#知识索引"></a> 知识索引</h2><p><strong>正样本/负样本</strong></p><p>正样本是指属于某一类别的样本,反样本是指不属于某一类别的样本。</p><p><strong>Intersection over Union - IoU - 交并比</strong></p><p><img src="/img/article/2021/10/30/13.png" alt="" /></p><p>交并比 (Intersection-over-Union，IoU)，是候选框(candidate bound) 与 原标记框(ground-truth bounding box)的交叠率，即它们的交集与并集的比值。</p><p>一般情况下，0.5 是阈值，用来判断预测的边界框是否正确。如果你希望更严格一点，你可以将 IoU 定得更高，比如说大于 0.6 或者更大的数字。IoU 越高，边界框越精确。</p><h2 id="个人反思总结"><a class="markdownIt-Anchor" href="#个人反思总结"></a> 个人反思总结</h2><blockquote><ol><li><p>接触到了许多陌生的概念，读起来感觉有些吃力</p><p>(</p><p>有时非常搞不懂某一步的意义:</p><ul><li>为什么要做这一步，作者是怎么想到要这样做的</li><li>这一步是怎么推导实现的？【突然出现一个公式或是算法，让人感觉摸不着头脑】</li></ul><p>)，</p><ol start="2"><li>应该先找找比较经典的CV论文看看，打好基础</li></ol></li><li><p>很多论文之间的思路都具有关联性，只有多看才能真正理解作者的思路</p></li></ol></blockquote>]]></content>
    
    
    <categories>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机视觉</tag>
      
      <tag>旋转目标检测</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>保研后记</title>
    <link href="/2021/10/06/Diary/20211006-%E4%BF%9D%E7%A0%94%E5%90%8E%E8%AE%B0/"/>
    <url>/2021/10/06/Diary/20211006-%E4%BF%9D%E7%A0%94%E5%90%8E%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="079a60d0107f4c0da05e58625d0a3df8484f9b8aaaa6d10f3b621f145e4e22bb">10d79030e8222445804370796b90fca1b3149e2c2a0f36d6b4ea04e548758c219d5ce3f3ea33aadd8650b46a4ea9e603f7ed139b64c27d0c8eaaaa4dc2038915e34ae6c879d454ee122b9a657114dd93066bf077e7deeef2a5bb90debeb851790c0fedda0d4e47f63c66c315fce9a8093806e529b403a8594264e1b038acbd35c21b563c71581e12e06ded51e5ee3028857bd8c5da677250e1cd07e715e9a7c39dbcd9cf49f6153b9daa2f4d6fc0de87cfaf056723b909d10557068f9e4016091cef38be85e423bc368d2f7be83eddf65fe51bfdfe3ac19114a78749956b73d134ae6ed0971ffc001914da4d1fdedf72386b8cb55aa990bc283da562725679a9a9b6ed09edb7265fd57ab3d413de97f282a41b799b09d91cc17d56fc02c6c202f94a1f8a8eefa30cf49007fc7c1de65d199068c99c133c1ff9d2c0d39a34e3c2f7a06eae8d74bab6f4282c355a64c1a231af52e10b5f9b09379f650b90304ce6d01ff36a26d7c085c5f844d1916c5434c3cc792347e8978b7cf4b12dddca964fe9a6832cc0a4aee40ae4633ff43350bc2b7a0a0aa37d9fd792a373185d8da39b818d057b57fbdff5b0564d4f21896d1ffcaab4a174e7091a85aa7d3b693ef24e6024e55cddbddebf2254cae886874cebef5379ed16add84f0e6b96d6dcd9e43fa0f49c4db27dc216a057b8129ffa41706d6c99ca9fccc73772421c69c2c5a23f0291e1475350e3d60011da243ab77592312b6145a8b428378354b5613b4e110a7020e592b8bff78b638b8c4eaeb41a4df23ca6f67fcf199dfdef5e686fbd673add73bd047bd25f4b94c097e85fbd7423da9cc807a86222768201bcadcc1755748af78d64af08188ec164e141e779541026b9032637798ff93feb5f5fd604f937e33a27e32daf1e5d3f587842a11fa028ff05aa3fefabefd82d3732ac8b6ca38634300957ca5b8035215f3c736ebf19ead27140c7916c9a8d3664ae6c4920a5f9f5c02eca276ad4d792e586c501381d7c6002ad760843d861d05df0361254a76b424055b7d232e77681747c6b7f145dec8bf18fc8a154cdaa6bbe05264033baac440140ad2db01bfd25a80bce7efcea98d5060c32fc36533baf912766ea8ce0768f11089ef09543702411d3a755dbc3675c17d531704273236d86b0b83c95f5a5a6178591d2dbfc205f2ca0a3e769f8b8a17bc08fdec48691bef5cd013646d0307fc31140ac741eafa788759fc98e52865afb430b9ccfbae3f57c29caad7d7a5977bd1794727aaf64e6c4adc55474b9177d9c125c4dfa08c4923bff577c3c1b6d89d75190b61321fa87a935004bb1b07fa63097ce62a1ebd8ebf34ea5da565bf8d4eaa79a93060d61e50862d9ee6bf52515f77c915f3d03ff8b107be7277c6065ca38b7c2eab7cdde4db05931983e913027f6b0251ade1d1a849e464994d4ecef1d029d524e3be6f77be3b12768d628382c8f8dab5e0ffb963b07a4a3c8bd3405691fe469f04448e26dcbf02fbc3953bf793ba5d1071e6e1392d5e5b9f19a90af86664896d916d8d2064ceb15a0100b47c6ff9b2a14ebc51820aa0979355ce5f2f5079dfe5065e3cce4faccc3e67caea2d98c46b93232062ac594c31a57a57c4015a7fcff72c308eefdb9bcd657360b46857928f949a606fa9aeb2488013ad976cf92d91464b2bb8faaa4c8858a51a6c9335011d23f0e7e312c0312cb05403dff14b5257a502c151343dfef58e26d28095917ae985864dedc781485d237942363e83db48a3e82a6d3d41b0a0f25c77fc38861b7e2a3a30a08e4827c74e10b581b6eca94533585842644ee8bc474f84238b59fe413b86397fdfd02dc8593b1b6944c9508dd4f74738839f1253fc1a990c757b0f6aeb1bd001850c04fe29a3553073d930fe58740ed94f57c0bec243ea5b0d334ff74c9a883de5fea7ecd97bd8e08ee4b00dbdba7996bc9f9c96bbdbc58e078357a9b8d6215239589ca7e12b0fc057bbf5fa77a428d2f8c4755aaf35eb939f08a5a6fc5fae13d03e03a7d1dec68a2a3cd327658a1844bc45a785ad03f82baa399d868a161d5020cb894936eb81214c139d913a66cca01ccc526c144231a4d2f2d2dc9d5819a89184307670a9af9a0135e54aa5b7d8456a731124c174769bcd8e9ff601462ab3e9c58505f09cc3b2e5e7da541e669823454d561de4033d639226eabf5bbbea0badeb9a15620815faee0fa8c3dd039eea0ed8c702fb876e5b6f17eefdac4479316f2fbc4867e64673c3fee742d4decfec1ff861c1193d484c065a285befe38dc0f3979c65ab89cabd9ed81d061360a997f37a285f031c451b244a1f3c60909004a74426083a661084a8d645d42eb24538a47069c4e885aa96e401c641e0e964ca7a03da8ebb796943fbcbe98ff6161d9d813309771f32ce4678080655859fb175189517b4512ee62228a5b93050f41396bf6558fb04e87ac7eb9802ef0bf019d46ea97879b74873e4511af36418aaabd0b117b05e093bfdab0a5f6a4af53d9f2f48224111952173b13dbf8e931f5be739f887c67eada8b812693dd44ac0354acc0a201976cacd2371df1dceb6a3bcc22ac6489a7f4457305a94681bb6100751629a61eb8a5d923704b3314f1396c4ef9d5a815f0ded17e7ac6099933fdafb61dabd444027259b9fd9cd83ece5725c2f4a1d6b4bd328df1724d0f9c1384a2e3374e5550df32fea0bf2ccb08bd3911fa74339ef4523f09037c3a0beb5a503a1f198ea044af6d023a877b2af1c81302dcf85693bb284e9692821b557e26a9c1acabd439026843c056576ccd6255a86c8576b68cca8dce1710b371bbbd06260bdd7c4e96debe24e4e8ca1643cb47ab5911e78b21b485cabc6615fd9778da5f3e134bb83ec4d8ec5d06a96160657d43f500dc11b6186fa953d97ccf2d681fd661a25dc7b11291b202d088eb382d404cc27bba713a661f66643afc3eaf48eb1e4d863293ef5c0857404e53f90f676814b1025e98a4192c273e381256aa6eb979ed026bef9cf20d1fff099439ac08a65b50570e0bd195848a09c2c8fec99e28c2cc183adfe44a17a320705343f7ec42c79bbfb4b8e33e92254294bd647de9155a9cc76e6fa6fe902eaf9fa28bf741c8c5acd646c73ad213e15a39f248e13e101994ef73308f97fc3af8aaa6afc8fca8d44ac97c0937dd5ec6a3ec66c16f756cbb4d2b2653789043e90c505a921db6cc8cf7d1d188bcbe16b3ebdb546c64372fbd8fb64a18653177bca3b60cabd38a2d1a42e6e0fd055cf7aa9ad186acda642b1162a31f648c9782c03549b3b90f8e4c928dcc88d32e27a20bce89a84c4220076c30e336f6e69caed17dc41741aa6d0fcb720c2a870e2eea6e43904b0834e5fa6e8057f2f2a50bc38cbd2064de070b131298b9f29f5777a2224419219868e07b74f617e33fa767f0862d649003d27767898fdfb69ac59e48b3aebb4b3b889ac51be3919004e21273f50e916d79436fe912ed041af8f600da777f456ad2126b27cb3b8123f3a61702baa9073600f9ff9564c21c6f2cbf4dedd7b053c0ed80eb419dafae92b5e24dd4670f1fa7066badac90fddf5d76b4d617fcb9a6707341e6b355d9499ac92b5b42e97fd1e4dc2f3ca3828d6e9f119f1f4d04a02d6522d3bc1caedd187f278533720f4df6810acba8f8415e83205898474120e96238430371ce0fa32a630aef29fa2b9980eda487abd30e350136be945148261371eb48eee54b736abb4bfff7dd57dae0d4027f1dec847423f267620407343f3896b3e86c1a860b13a7e71cac466919a7b1262abef676990219f7c5282d2f284ff1b498e4790f4d3d0e73e8b677af88a15a7b1e762ed7e23935de073ec7058dfacbb1de07fe887c6ab1267b8f374f3aeb324542368b0f42ae9575da83024a1d98d57984516cc53213223d183873cc48ce888ef8bbff3f1145deb1f6095e7450e47a2e4b4b0d9a459b5d75764f9cf5f756ddbf52be0fe64300a367d83a3a9fdab8c62da828f6989f448649d650cbb60df20735f50cad83384b505039a537c7a2e68c11e0dce1b9376fa930346d12ec2273c8e421557dd04c1d4d52beb19b1648fdaf11e3d9e545212e9983ac2343430d67aa643d18b5de621fb14cf9e27984c99937779065fee1d57270851f012c971bd87c3bbbd4f04397bd39a5b87d17dd7294e938fd26c4e21715d8397d059c24ffeaba06af12d8bdc384d788b9351b3bf432c4aa6d276ea30f92203cce5edf007bf397648a7f1d6a979f5d559549282e16266ad65392cb5ba92a626348b783b2e991ceb9e31fb908d9bf29621a0aae7b8109396c25134c087d4dc776214b87cb9109d18d76aca9ecaa147536cafc38c6cc30b0c0502f2441f5eefbd515bd41b77a97ee8094701f7bd2748e39db8e97d4a8ba46f482038c6a9f7abd7217bb57c396eaac94dde6d511235630d9a1460feb7dd6fc1a04065e1994c1efc3cd0163d5e25bf79ec04f30211a47bbca84f2ab2d427fb8d331283503a4416911fbb3a47186425320800d00e809efdc1d45872be620d1bdc9893dc8817c549c3c9d2851aeafe12ebe688fd8ae3da5669a7090391125c1090279b70eeed57c3efc1def757eb5e84048e2b997e07d410f53ccee67a390d82567bfa6afe45d784cf953342c5c77f54dd19f01977bce196281dfbeeb310f8aefd690fdf5c32978103769598cc3899e0843d3976b4121115362ea29d6b11a85eb3ffa8a55b441e37450ef6ea9833bc3ec6e87f9a467abc33432f4bd7147015b34c79dea93dbd4013bbc10823b71b59fd85c2acfc62faf7f5c0dfb9120cb7185932eacb1cfa92969bb7cea2d4da78cfe4b714d1b9fd9b0e87a7d261a01ed69c8c99cf44a21d4bf16101e95bd7f969c5accb0796fd57dbd79a127169d3c3d4a26fc3e3f6d845cadbcfd1e9be2c4dae48874bbe32c3344235ccd8fef2c15016a901e74dd6b1f0ade0693a7ef823f373e61ad09c83b425480f2fd8c8003942752fa5c92b17e246c5f1c0d73ac214909398d31f7399c42d20dbc1332a11dbf91612d3fe18c4cb8f787ba9a2e2cfd88002467aaef616844552797c3d348178bf1687f34c5583ae7c5a3df63a5a8743493f3be3459199d6f0f42619193997c20084407ddafb239eda3ee203e0daf13ec7e444b68a151e4c79ef4155fc6d79f4285a24bf26c144691ddd6e25ed84a4357eac2b13e164f0205737c88e9a084e217147295ad91d22c0a268bfdd60b3f91e26f93c52560c156dc90e1294b97832058d525b26d26debd25f934e491dacaa46fd98b39ca16cdf867fbf4ead82a683812674217c4576368a46a3bee240f3c6806d662b9a2f71ebcdc881365b323f88368d620eb6cd3f806de54e9dfddbd50c3788c5e691d814f818e8b5aeaf0c805a52b4f801a66a3c75b89b5bdc9ce901d4d6cfb785c850425bd58d19cafe16a574404381df60a4fc80ee7b44f36504142ea03d0ff425cf7afb774bcd8d3630688d833a888f6784658094cc582a5992c39f1f0b1a8b02cf1a04ca73601e089db418ac37573843cd226cc1fe6705c612815142d15161ea9950b9321fcf913226a4e17f87fbe4f4801c9749d0f081dc2fc6d4ebc0c8af69f4a5fbfd4ba2478a98ce633f4f48739f4db72f6d2ccacc6429671d90326f0c124b5b294339c4c1f43e99da4b1da14319f4e2313e235406a9010dd000e87c9523a28dd5b11cae419498b0e872a28a70b5a7f10bb6ab2cc513e0ef113e025514d9f78e239d90db0d4334038667e42b68fdb47acf87705fced8d7e350c3213f98bd74ba812d3cbff7866d0c38bf900a03086d57c1a1b1638972393deaf09e88bf85119a3aaa3834358f1df63fbbb9486e0480a444fa86b92208294055cbb2621dd3e2a24a0313d551d3c86c9d0243330496184ff5e9f5264cf247b7bbf762862e02ba19b8be835d48294037062497b31dced33facc4e09741566e0a1e89ee71f0e9b2ac1233e5c22963d3b547be62a0630e4379f2b30feadf939196813639d9263d097bcabdf2ca7f0e4fb4217a1451f29c606704bd52e074ceb3ef537df60e7b7e318d83326014ea0b152b028a91317bd510891e1c7da0fb7dad32cea88af3257de230a5ca0ad9c2b1c3914ad73d9166c446f6b1b9f25b12640c669a7e1cf87449a29673f7a79cda42e232881e24ad278f802aebaf5460ba94d87d43f9684dcd6eded9163958aa6eed6433ad53e3bed375a5e3de3d3829b145dd74899fe3d7e45cfa1e4544955e9f56271bb9dc2875f5d4ef6809b77c4fa08aba2642c79324fb4fa584ec47822692f632102f1d6bf7e09d903da1d6a1ab031e89d92d1e321b9b6ba44b543bb1754f52b3a5b5937b764b1c6e9b9d5ec0218f5f493ded2bdc71cb3bc82faf0280a3dae4cbbf7ebb54659ae6e0fae343bedcf507dc6200d9a2fc172ea39d2592fed216ef63c24fffb3772a8826ec45777455a322780cd521977fc48933669ecd938d1818b25e7f482b2546f576c595b3a4916c6bba16a22cda9c223f171ddce4882264e57c49437c85bcc1f91647cbb6e6cd5bbdc3119ace42caa271efa8ea79327b61d6ec4315ac0b5e494658afb1e26b2c0dfa13dd6eeb0e21432546ebc58624c93fa815f09483ac2ec144af75b2df3b124ec3e9a8c538b06c5b3237b8f852b09139441a5950c48fc58deb293e5d7d89fbfe35e89b29edf07f6c26e8307fc1a5e5c6b8fef8b3d4295f9256099134159033c540c975a41da8d005d6c1a221471474817d9dfc637d3b64799ed1d31410b2ba5dc92338332ddb3f723eea76ae5acec79277d583ecc5bec210b168c3309cac267d0e5a19d53c7143ee2ba8ae4a9d6c2c7fb4525809a8aac178b24c35f6b54bf0033f65b6ff4f708e7798b8bbdedf27ed514f008ace3ed9fae782747e1fc466e233ebf9d11b39c4413aa7a1e7e6f24730bae4a3d5adb19618f21df7b82b81620f92fed16fecd543c88389bbd6e0228ad25d59efa93280cfebd19470c1adea3d9125aec0522e92929aaf0e34d181629441e5f1c90c867fa878f843e3583745c20b075bd72ea26d0ac363f9c14283913c35ab67ca2bb58066c98ae40efef56b86a33cca91068420a81dc66dca36b599b668e80ae9d22b88e8224a34aa404fc5dbece4637f902abab1ede6df0275c19534234753e41f4b62b4ba4f7ab301fd039e9b812f0e1f95476685c453a844f1315f6635b49da05cad2161871072b04a0f646ada4bba7dace1275abc33f7229ae058966b86c41b19ae703eff909eb458ef277801c279e357ede4e5b985589ac248e712df4a0d6aa61e9a4d699f591f1ce3091e5e83b24bec3a44279b99d0e4854fde4e339f01e7644270bfb3df94502381f45a6786637aef30e79c625047da779c469ebbff3d96fd2aa948fbab93cb35e1768223dc642626a03a4d33001cf16394fdba566a6e88b663dd826c7dcce9bd0809fc25c035e5246846b00b5f6634de9a24b3d1ffffc0e8a722258b17872747d183c20431d9374ab0044e1e98064d01647401c2e06b58cd1337b1a161b1a4ccb3cc9bce3212a61da639d5b6e2920c00f9128a63cef7eeb2303762c294aad25de0c102b80e2d1b7e4a1176166709a79717808f5b603fc70c4a768560a64f9b6837b30b3b0f1d94083417d6b4188e844d0106c8156f3be94136fd9ee547b841e2fcbda89a22913cf32502e20e05b4c792ed34ff7dc4e9c843b9807043213b73fb92c9fba027cd005ccb696f204522625514d105f25fe8170753936d1a85a6ea044a0f6741be1aece6f0a42367c6daa616322e40101bc0792352835367b63107c101c88547003bba2c77d06772fa1c63c7f3baa682c8ca39196bd73363d20516331b4e73b5cead1c4094f87d2c0beadc2a38f9c9b3172853071782ea6928425dd9e6edcdc0021cb6ff06fa22c6a9d6f87c73421ee7fffa2c0ec1382015ba57ff66bc1f4d99589730cd6875d0e691821a705b47e85fd4737c2313f0385040c6417c6bb2a07b21ebdd17b0c1cb26f269bc371cefbd8873edcb5f5b7be9856a8de9db722d8eb5b6210ce54f311172def7c0f3d0a7c86dc496779221ea7ed9f4b64c8cf7b93336c29165dd3d69a6170dcf7df0e3f4a45d5281275ce771b0816c480f6ecc8c8f663be4e211bbb2d77ea52dde20cdef8f8dfa04c3c1c2535a3c47005900b39c730dfa35e129775a551bb2a8229b8d978270c2fb29a8e53af57dceca77ef826318925e8cfd1f0e4d8fa5ac11e4dc2b23a898d46532ca3a6c3a5923509beb54d63db61673b7b13ae3122f84317489ff8cea18f44759cead8a7d5f8b0cf9adb38ab5c2a47c7dce47128a33a77929d8540e4e59a0d75d156dec2f07cd7ced4eb1e71ec568bef964a62d8972a8e48933e71de20841836e4d72c70660688050b753d84b69edce84c74593ed97a539414523f092866783dbfa7e24b84f910a3335f2a4e091704924da268b0ed3b40af38e462c3f00cd5c98c628c83e605674ef94e740deedbbe4f5547c95311c206c4e34efad4a694545052c9505cffb513d537d9533f9946ddf0c0b4bb9c380a9d47081655b77fbdca769a84244e1614b2687760108cd02c2c37343a39279657571509d8bdbd38777b3532661d8b4d7fcf76d83bcc82a5ede3a85230374621cce6d4cc3c2889b53460b85727b0272a91d9db17d07f74f8d160ba71b27b35837557974fa7ece047f2f9e08a17f8d654542fb2ea8ed3c2045ace81633cfc19a7a21bbf94c80019ee829ad04cabc82d1012ee3bb0d3a806983a5a96dd9c2a374f1007f354e018486e536e0d3e22fc54cfeb7cee8e5c14edc5500c84eedf794353f79e97f95a68a296bc29cdf2917e54a7db1dcbaca72f61949da59329a13e77fadc3ca6e04ab0d17b8fd443731eb2dac622f1014a2e3f3e6835c968e4eefb797c3367fea2fe3d24fdd6cfecc7f9e2193b1bc5e69c944219c3d3b0b014b74a400f18658d1cf3bdddc999d2580fd70d85ff155ff34a6e9a02fb4911737cb96edc4ef29e18e4283f3bd627b9740b54f23928ae6fb1fffc8799a0a6e039927ca6a1923f76e6621ba120b64bf0773f25042e67648bc0ce547bfed24f993254685a6c4b313069e66cafa4d8f90cb40d5b786a618a0062a0bd9bc6601627c9538047ec865b727b8b2fe5e506a848bacf9da8380c495743a9fa1cb5870569d978e6c9f68d16681a178069e5da5b539f83e54056e710ab26a89782ba06b4cae9e34c66d25a04fdb8b9ae4200cb422682789f2ea9e964dd62a9ade512ff49340dca4d0a6687468397df9e89383fba9bff630ee16ab9396db47283e648873ba5f9375aadf93558e3e4a2e3b740d16d29b1ea0070a8957866e1067e25e66a46089869b58ca3e94957b37914ad9d7c5decbb7d26718d561751c22bad64b2b9986748923c15b644d1ae03eb2e60e5bb52fb4eeff9289cd41066f36f748a460a4aca3fd527764d33931fc361530983ba7121deeecc87bfe8a16e08d6c2a6c7f57b2383cfdab65a9a94ef63906bb7c0c82767083a9a3a5e20c5726b3935ce932fca806876d5caf19e3b426f392c47e3f52440c2d8b39dc0a64d03a92f7607882d488600a9040bcd9fc2023fa95574e0dde72c0a8616f5e476d89da2c1ec1feb1c49f07cb54a65afa5e15bb4d4fa551698bc80f0ad42025b266662043a2313114ea184f685a08ae0cf32d6cbaa97239b604b062c69a70a149adcca16526376f19e0172c405793284c5aef64bc6c4b997da8b6884d33c52e843bedb75e90b3ee982de18616be23ba8f19887f1ecc788c1cdb60bd7257d56bf0a3f6aff5586f651f22e5d9abf1c9e8402c8c5eb202f87e93227cf8f42541fd64bc0d87e0930f2ccbca651db3375a609d3385011d1e8ef0258c5fe0a93d5867e91ac066984bd9a0d06dddae17473718fb1e3972083ff4ded80c028b8bcef5771141d74dddfef515414c90fe1ecf2c9536ab20df5449c2cfb3410a8fb9a2abfbc372dffbc0bf7dbf8201a4e0eac25dead31be16224fda091fdc2cc47f25f2debfd18019b27c80f66ffb721699ebcca6e556337f7417d88999b55c84d94ec41de7a4dcbd9b78c41d7f95616aa10d00ac20f092f23c1aa602e010d177199cb24deaad0f72002689c4107f891e40aeb05aaf890e45d11284975dd87c1b22592f1f39897c15f5bb1d3702a2c007800416415ee7cd96df584a8ae48dec993c0900f632e1e16bb8a408643ed41e66d663d06a9255583f71ef090dd395bb626b88fb0000b694cd0e30d24cda2747ef9cf6a20163db50e4d512a5c437f577b0e61c989871bd018083b0b4539bf7d7de15e669081e47fd1889eeee26b97f6ecb0a23837059b0bf3a5bac24b30bfc28ae9837d9e1c7141e7e8e6c833a23bd0a2c3738a91abd501073da55bd6d715b3dc7520c9ab41cbb9622736221530d6ba6d9fd557f700403f2ad0ef51ead2cf4b63b1f77da13500579c05499d9d4f57f4b509d451a8ec081ee13bf5b334e51e1882ca0fdc3b6b8587e7cdc5e71206702e17ba7e9c05ed3cac5afcfb9d195044a425f2d56f6399ee29c66b7338bdbd63595f5941116d58c7c3dd8971afde556a9c8e80c00435a580541cc8322e8521a4f7b7df25dfff958558d630b68a5d974917ed44764b2c74759fc5bdc19934279c7240d746fcccaaf5dccc9334683e441aff65e0b38734cc711b7c609a04ff87dcd3853603d63bc6fe828eb4e9a96d42e9af2210c382e9087a8795682a77349e9ac7cb65e266bdc0a00577056152fabeccb4192106b654a70b7bd950d9b4ed0bdd190b9ab8189ff15c9490c6d1f89f927f13e987138296a7cc7931bb9b2fdf7fab9954f544b88a36459bf8ba54191f58c49ad1190d2e95624320b67a9312cbe70b5f8dcbc9122b8ddac20291f4d0e847b0a3da4629a20ee2e6cbd8a5e97172f9e1fbc11ca6d009f1bf03b6fbe5cefbcf4e103fef75ce266a0796739544798fc71d2b0ab96632cadcb1226ff408c9792665d792d91d60392924ef6561d892eef5ec528000676df46b5276937ae0c8f6f7bdb4fc4c07ca34a0dad719bb942be3d9114002b2b1f9ba175a8cf04d149f865b504b956fc41ab2a70e5a747a91fff3ab3d59283a4d9be71b0a1cb28d7ded168fa55fc16ba17619433213a5fc8f152579044a701f8f6fe08932e63b93b067ec3dd0dfa8a19c0e7439e1d09f0ddd320fcdf57a75428ea28b172cb408ed863b841bbe0961f9b9850ec18e397c1adde4ee3218d7256c4a5ccff89a3332ed53fe252e217131a31e1f6630ae105eff65184b07d0d7bf6a11ee02e6a64760f3348</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Plz enter the password.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>随笔</category>
      
    </categories>
    
    
    <tags>
      
      <tag>保研</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>更换GPU——重跑Mask-RCNN Demo</title>
    <link href="/2021/05/20/AI-Learning/20210520-%E4%BD%BF%E7%94%A8GPU%E8%B7%91MaskRCNN/"/>
    <url>/2021/05/20/AI-Learning/20210520-%E4%BD%BF%E7%94%A8GPU%E8%B7%91MaskRCNN/</url>
    
    <content type="html"><![CDATA[<h1 id="使用gpu跑mask-rcnn-demo"><a class="markdownIt-Anchor" href="#使用gpu跑mask-rcnn-demo"></a> 使用GPU跑Mask-RCNN Demo</h1><p>使用CPU跑深度学习当然没问题，但是随着深度学习往CV方向(计算机视觉)发展，需要计算机不断对图像进行处理，由此伴随着网络层数的加深，可能会让你的CPU会越来越力不从心！</p><p>而GPU(Graphics Processing Unit)就是为了处理图像而诞生的，因此这是GPU与生俱来的优势，</p><p>让我们通过以下这个短视频来体会一下CPU与GPU的区别吧</p><p>视频需要使用Dplayer视频插件，日后更新上来</p><p>OK，了解完GPU的强大之处后，就让我们把之前的Mask-RCNN项目换成GPU跑一遍吧！</p><p><strong>注</strong>: 本文以下内容：需要电脑至少有一块NVIDA(英伟达)GPU处理器才能顺利进行</p><p>本文Demo运行的外部环境: Win10(64bits) + Anaconda3(2020.11版) + GTX 1060 Max-Q</p><h2 id="cudacudnn"><a class="markdownIt-Anchor" href="#cudacudnn"></a> CUDA&amp;cuDNN</h2><p>CUDA(Compute Unified Device Architecture)，是显卡厂商NVIDIA推出的运算平台。</p><p>cuDNN(CUDA Deep Neural Network)是基于CUDA运算平台，用于深度神经网络的GPU加速库。</p><p>要想实现使用GPU运行Mask-RCNN Demo，必须先安装CUDA和cuDNN</p><h3 id="查看cuda版本支持"><a class="markdownIt-Anchor" href="#查看cuda版本支持"></a> 查看CUDA版本支持</h3><p>首先，来查看你电脑上能支持的CUDA的最高版本吧!</p><p><strong>Step1</strong>:打开cmd命令行窗口，输入<code>nvidia-smi</code>可以看到如下内容:</p><p><img src="/img/article/2021/05/20/1.png" alt="" /></p><p>圈起来的部分就是你的NVIDIA显卡所支持的CUDA版本，本文所使用的电脑最高支持CUDA11.1。</p><blockquote><p>如果输入<code>nvidia-smi</code>提示未找到命令，需要在环境变量Path中添加:</p><p>``C:\Program Files\NVIDIA Corporation\NVSMI`</p></blockquote><p>在后面的下载安装步骤中，首先需要保证 <strong>选择安装的cuda版本</strong> <strong>&lt;=</strong>  <strong>cmd内显示的支持版本</strong></p><p>并且你需要参考下图版本对应关系，保证CUDA、cuDNN、Python、tensorflow-gpu的版本一致性。</p><p><img src="/img/article/2021/05/20/2.png" alt="" /></p><blockquote><p>本文基于的环境配置版本为:</p><ul><li><p>tensorflow-gpu-1.5.0</p></li><li><p>python3.6</p></li><li><p>CUDA9.0</p></li><li><p>cuDNN7.0.5</p></li></ul></blockquote><h3 id="安装cuda"><a class="markdownIt-Anchor" href="#安装cuda"></a> 安装CUDA</h3><p><strong>CUDA已发布版本</strong> ：<a href="https://developer.nvidia.com/cuda-toolkit-archive">https://developer.nvidia.com/cuda-toolkit-archive</a></p><p>本文选择下载安装CUDA9.0(因为之前跑Demo时已经安装tensorflow-gpu-1.5.0了)</p><p>国内下载速度较慢，需要使用外网，如果你也选择安装CUDA9.0版本，可以选择从我的百度网盘中下载。</p><p><strong>Step1</strong>: 访问NVIDIA官网，选择下载CUDA9.0</p><p><img src="/img/article/2021/05/20/3.png" alt="" /></p><p><img src="/img/article/2021/05/20/4.png" alt="" /></p><p><img src="/img/article/2021/05/20/5.png" alt="" /></p><p><strong>Step2</strong>: 安装CUDA9.0</p><p>运行安装程序：</p><p><img src="/img/article/2021/05/20/6.png" alt="" /></p><p>选择自定义，然后勾选全部安装：</p><p><img src="/img/article/2021/05/20/7.png" alt="" /></p><p>安装位置推荐不要改动，就在C盘就行：</p><p><img src="/img/article/2021/05/20/8.png" alt="" /></p><p>这里还要求电脑安装过Visual Studio (2015/2017)，不然装不上nsight：</p><p>本文电脑已安装VS2017</p><p><img src="/img/article/2021/05/20/10.png" alt="" /></p><p>安装完成：</p><p><img src="/img/article/2021/05/20/9.png" alt="" /></p><h3 id="安装cudnn"><a class="markdownIt-Anchor" href="#安装cudnn"></a> 安装cuDNN</h3><p><strong>CUDNN历史版本</strong> ：<a href="https://developer.nvidia.com/rdp/cudnn-archive">https://developer.nvidia.com/rdp/cudnn-archive</a></p><p>本文选择下载安装cuDNN7.0.5(与CUDA9.0版本对应)</p><p>国内下载速度较慢，需要使用外网，如果你也选择安装cuDNN7.0.5版本，可以选择从我的百度网盘中下载。</p><p><strong>Step1</strong>: 访问NVIDIA官网，选择下载cuDNN9.0</p><p><img src="/img/article/2021/05/20/11.png" alt="" /></p><p>下载好cuDNN，解压，把对应文件夹中的东西复制进去即可。</p><h2 id="tensorflow-gpu"><a class="markdownIt-Anchor" href="#tensorflow-gpu"></a> Tensorflow-gpu</h2><p>如果你有参考我上一篇文章，并成功跑起了Demo，那么已经安装过tensorflow-gpu了</p><p>运行如下程序来简单测试是否正在使用GPU进行运算:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token comment"># os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'</span><span class="token comment"># 使用编号为0的GPU</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">"CUDA_VISIBLE_DEVICES"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0'</span><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>client <span class="token keyword">import</span> device_lib<span class="token keyword">print</span><span class="token punctuation">(</span>device_lib<span class="token punctuation">.</span>list_local_devices<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>test<span class="token punctuation">.</span>gpu_device_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sess<span class="token operator">=</span>tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>a<span class="token operator">=</span>tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>b<span class="token operator">=</span>tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>可能遇到的问题：</p><p>为什么Tensorflow还是使用的CPU而非GPU？</p><h2 id="demo运行"><a class="markdownIt-Anchor" href="#demo运行"></a> Demo运行</h2><h2 id="碰壁"><a class="markdownIt-Anchor" href="#碰壁"></a> 碰壁</h2><h3 id="为什么tensorflow还是使用的cpu而非gpu"><a class="markdownIt-Anchor" href="#为什么tensorflow还是使用的cpu而非gpu"></a> 为什么Tensorflow还是使用的CPU而非GPU</h3><p>如果你既安装了tensorflow，又安装了tensorflow-gpu，请保证tensorflow-gpu版本&gt;=tensorflow版本</p><p>最保险的方法，是把tensorflow和tensorflow-gpu都卸了，并只重新安装tensorflow-gpu</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 卸载</span>conda uninstall <span class="token assign-left variable">tensorflow</span><span class="token operator">==</span><span class="token number">1.5</span>.0conda uninstall tensorflow-gpu<span class="token operator">==</span><span class="token number">1.5</span>.0<span class="token comment"># 重新安装</span>conda <span class="token function">install</span> tensorflow-gpu<span class="token operator">==</span><span class="token number">1.5</span>.0</code></pre><p>然后再运行上面的测试.py试试。</p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>卷积神经网络</tag>
      
      <tag>计算机视觉</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>从0开始——跑起Mask-RCNN Demo</title>
    <link href="/2021/05/16/AI-Learning/20210516-%E4%BB%8E0%E5%BC%80%E5%A7%8BMaskRCNN/"/>
    <url>/2021/05/16/AI-Learning/20210516-%E4%BB%8E0%E5%BC%80%E5%A7%8BMaskRCNN/</url>
    
    <content type="html"><![CDATA[<h1 id="从0开始跑起mask-rcnn-demo"><a class="markdownIt-Anchor" href="#从0开始跑起mask-rcnn-demo"></a> 从0开始——跑起Mask-RCNN Demo</h1><p>本教程适用于0基础入门机器学习的Coder，阅读完之后你将能在你的电脑上跑起来Mask-RCNN官方的Demo噢！</p><p>俗话说: 再🐮的理论也要首先通过实践，把项目跑起来才是硬道理，代码可以之后慢慢研究！</p><p>基于以上原则，本教程:</p><ul><li>只专注于Demo运行的环境配置</li><li>不带有任何机器学习原理的代码原理讲解</li></ul><p>本文Demo运行的外部环境: Win10(64bits) + Anaconda3(2020.11版)</p><h2 id="maskrcnn"><a class="markdownIt-Anchor" href="#maskrcnn"></a> MaskRCNN</h2><h3 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h3><p>​   大名鼎鼎的 Mask RCNN 一举夺得 ICCV2017 Best Paper，名声大造。Mask RCNN 是何恺明基于以往的 Faster RCNN 架构提出的新的卷积网络，实现高效地检测图中的物体，并同时生成一张高质量的每个个体的分割掩码，即有效地目标的同时完成了高质量的语义分割。</p><p><img src="/img/article/2021/05/16/1.png" alt="" /></p><p><strong>论文地址</strong>:  <em><a href="https://arxiv.org/abs/1703.06870">https://arxiv.org/abs/1703.06870</a></em></p><h3 id="项目下载"><a class="markdownIt-Anchor" href="#项目下载"></a> 项目下载</h3><p><strong>项目开源地址</strong>: <em><a href="https://github.com/matterport/Mask_RCNN">https://github.com/matterport/Mask_RCNN</a></em></p><p>在开源地址的<a href="https://github.com/matterport/Mask_RCNN/releases">项目release发布页</a>内:</p><ul><li>Mask R-CNN 2.1中下载balloon_dataset.zip、mask_rcnn_balloon.h5、 Source code(zip/tar.gz)</li></ul><p><img src="/img/article/2021/05/16/2.png" alt="" /></p><ul><li>Mask R-CNN 2.0中下载mask_rcnn_coco.h5</li></ul><p><img src="/img/article/2021/05/16/3.png" alt="" /></p><p>本次教程需要用到的只有Source code和mask_rcnn_coco.h5，其他下载的文件在进一步学习中会用到。</p><p>下载完成后，解压Source code，然后将mask_rcnn_coco放在主目录下:</p><p><img src="/img/article/2021/05/16/4.png" alt="" /></p><p>完成以上步骤后就做好了项目前期准备，本文的目的就是要__让Demo.ipynb成功运行__</p><p><img src="/img/article/2021/05/16/target.png" alt="" /></p><h2 id="anacondapython环境配置"><a class="markdownIt-Anchor" href="#anacondapython环境配置"></a> Anaconda[Python环境配置]</h2><p><strong>Anaconda官网下载地址</strong>:  <em><a href="https://www.anaconda.com/products/individual#Downloads">https://www.anaconda.com/products/individual#Downloads</a></em></p><p>安装较为简单，这里不花笔墨叙述如何安装Anaconda，不会可以自行百度Anaconda安装教程。</p><blockquote><p><em>Q</em> :我已经安装了python了，安装Anaconda会有冲突么，需要卸载python再安装Anaconda么？</p><p><em>A</em> :不会冲突，放心安装。Anaconda可以与现有的python版本共存,只要二者都配置了环境变量即可。</p></blockquote><p>给Anaconda换国内源，可以解决下载缓慢的问题=&gt;<a href="#jump1">Conda换源</a></p><p><span color=red>[注]:</span>以下安装命令中所有环境和库的版本，最好与本文版本相同，以免出现不必要的麻烦。</p><h3 id="python虚拟环境"><a class="markdownIt-Anchor" href="#python虚拟环境"></a> Python虚拟环境</h3><p>安装好Anaconda，并配置好环境变量后，打开cmd或Anaconda Prompt。</p><p>进行以下操作:</p><p><strong>Step1</strong>:  创建python3.6版本的虚拟环境</p><pre class="language-bash" data-language="bash"><code class="language-bash">conda create -n <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span>虚拟环境名<span class="token punctuation">]</span><span class="token variable">`</span></span> <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.6</span></code></pre><p>弹出(y/n)时，输入y即可。</p><p><strong>Step2</strong>:  虚拟环境基础操作命令</p><p><code>激活虚拟环境</code>:</p><pre class="language-bash" data-language="bash"><code class="language-bash">activate <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span>虚拟环境名<span class="token punctuation">]</span><span class="token variable">`</span></span></code></pre><p><code>退出虚拟环境</code>:</p><pre class="language-none"><code class="language-none">deactivate</code></pre><p><code>删除虚拟环境</code>:</p><pre class="language-bash" data-language="bash"><code class="language-bash">conda remove -n <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span>虚拟环境<span class="token punctuation">]</span><span class="token variable">`</span></span></code></pre><p>激活了虚拟环境后，使用conda/pip的安装命令只会给虚拟环境envs安装；</p><p>如果出现错误，可以选择直接删掉虚拟环境重来。</p><h3 id="jupyter-notebook配置"><a class="markdownIt-Anchor" href="#jupyter-notebook配置"></a> Jupyter Notebook配置</h3><p>一般使用Anaconda创建的python虚拟环境自带Jupyter Notebook，使用以下命令打开:</p><pre class="language-bash" data-language="bash"><code class="language-bash">jupyter notebook</code></pre><p>但自带的会有不完善的地方，这里补全。</p><p><strong>Step1</strong>: 安装nb_conda使Jupyter Notebook能够切换虚拟环境</p><pre class="language-none"><code class="language-none">conda install nb_conda</code></pre><p>安装后打开jupyter notebook 可以看到Conda插件，并显示环境，如下图:</p><p>[笔者的电脑上有root(基础python)、Anaconda2020.11(Anaconda自带)、python3.6(虚拟环境envs))三种环境]</p><p><img src="/img/article/2021/05/16/5.png" alt="" /></p><p>此处可能出现的相关错误:</p><p><a href="#jump2">打开jupyter notebook后，出现Dead Kenel</a></p><p><em>The kernel has died,and the automatic restart has failed.</em></p><p><img src="/img/article/2021/05/16/6.png" alt="" /></p><p>Jupyter NoteBook如果出现问题，一定要看看控制台cmd报了什么错误，根据该错误网上搜索解决</p><h3 id="python库安装"><a class="markdownIt-Anchor" href="#python库安装"></a> Python库安装</h3><p><strong>Step1</strong>: 根据github上Mask-RCNN的ReadMe，要安装requirements.txt中的python库</p><p><img src="/img/article/2021/05/16/7.png" alt="" /></p><p>然而各种库版本不对很容易导致各种问题，四处碰壁。这里推荐按本文的requirements.txt配置</p><p><img src="/img/article/2021/05/16/8.png" alt="" /></p><p>可以点击这里直接下载:<a href="/load/requirements.txt">requirements.txt</a></p><p>编辑好requirements.txt后，然后使用以下命令安装</p><pre class="language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> -r requirements.txt</code></pre><p>如果不按本文中的requirements.txt配置，请注意<a href="https://www.cnblogs.com/carle-09/p/11661261.html">Tensorflow和Keras版本对应</a></p><p><strong>Step2</strong>: <span id="jump6">安装coco库</span></p><p>该步骤需要区分Window系统和Linux系统安装</p><p><strong>Windows</strong> :</p><pre class="language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> pycocotools-windows</code></pre><p><strong>Linux</strong> :</p><p>【需要Linux已安装C语言编译器如cmaker】</p><p>方法1:</p><pre class="language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> git+https://github.com/waleedka/cocoapi.git<span class="token comment">#egg=pycocotools&amp;subdirectory=PythonAPI</span></code></pre><p>方法2:</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/waleedka/coco.git<span class="token builtin class-name">cd</span> coco/PythonAPI<span class="token function">make</span><span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span><span class="token function">sudo</span> python setup.py <span class="token function">install</span></code></pre><h2 id="demo运行"><a class="markdownIt-Anchor" href="#demo运行"></a> Demo运行</h2><p><strong>Step1</strong>: cmd打开jupyter notebook</p><pre class="language-bash" data-language="bash"><code class="language-bash">jupyter notebook</code></pre><p><img src="/img/article/2021/05/16/9.png" alt="" /></p><p><strong>Step2</strong>: 打开项目目录下的demo.ipynb，并切换Kenel为你的python3.6虚拟环境</p><p><img src="/img/article/2021/05/16/10.png" alt="" /></p><p><strong>Step3</strong>: 一路<code>Shift</code>+<code>Enter</code>，即可</p><p>Import库时看到如下图，则说明没问题:</p><p><img src="/img/article/2021/05/16/11.png" alt="" /></p><p>最后Run Object  Detection时，首先会看到数据:</p><p><img src="/img/article/2021/05/16/12.png" alt="" /></p><p>等待一会儿会出现训练测试图片:</p><p><img src="/img/article/2021/05/16/13.png" alt="" /></p><p>如果以上步骤完美运行，那么恭喜你，成功跑起来了Mask-RCNN的Demo！</p><p>此处可能出现的相关错误:</p><ol><li><p><a href="#jump3">ImportError: No module named ‘pycocotools’</a></p></li><li><p><a href="#jump4">AttributeError: ‘str’ object has no attribute ‘decode’</a></p></li><li><p><a href="#jump5">AttributeError:module ‘cipy.misc’ has no attribute ‘imresize’</a></p></li></ol><h2 id="碰壁"><a class="markdownIt-Anchor" href="#碰壁"></a> 碰壁</h2><h3 id="span-idjump1conda-换源span"><a class="markdownIt-Anchor" href="#span-idjump1conda-换源span"></a> <span id="jump1">Conda 换源</span></h3><p><strong>清华源</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/<span class="token comment"># 设置搜索时显示通道地址</span>conda config --set show_channel_urls <span class="token function">yes</span></code></pre><p><strong>中科大源</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/main/conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/free/conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/msys2/conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/bioconda/conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/menpo/<span class="token comment"># 设置搜索时显示通道地址</span>conda config --set show_channel_urls <span class="token function">yes</span></code></pre><h3 id="span-idjump2jupyter-notebook配置相关span"><a class="markdownIt-Anchor" href="#span-idjump2jupyter-notebook配置相关span"></a> <span id="jump2">Jupyter Notebook配置相关</span></h3><p><span style="font-weight:bold;">Dead Kenel内核死亡[ImportError: cannot import name ‘generator_to_async_generator’]</span></p><p>该内核死亡原因，查看cmd，抛出以下错误:</p><pre class="language-bash" data-language="bash"><code class="language-bash">ImportError: cannot <span class="token function">import</span> name <span class="token string">'generator_to_async_generator'</span></code></pre><p><strong>解决方法</strong>:  <a href="https://github.com/ipython/ipython/issues/11270">参考网页</a></p><p>先执行<code>2</code>次，完全卸载ipython 和 prompt_toolkit</p><pre class="language-bash" data-language="bash"><code class="language-bash">pip uninstall -y ipython prompt_toolkit</code></pre><p>再重新安装ipython prompt_toolkit</p><pre class="language-none"><code class="language-none">pip install ipython prompt_toolkit</code></pre><p><strong>[AttributeError: module ‘<a href="http://dateutil.tz">dateutil.tz</a>’ has no attribute ‘UTC’]</strong></p><p>该错误不容易发现，在jupyer notebook中表现为运行无反应。查看cmd，抛出以下错误:</p><pre class="language-bash" data-language="bash"><code class="language-bash">AttributeError: module <span class="token string">'dateutil.tz'</span> has no attribute <span class="token string">'UTC'</span></code></pre><p><strong>解决方法:</strong> <a href="https://stackoverflow.com/questions/60929286/attributeerror-module-dateutil-tz-has-no-attribute-utc-on-zappa-deploy">参考网页</a></p><p>重新强制安装python-dateutil</p><pre class="language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> python-dateutil --upgrade --force</code></pre><h3 id="demo运行相关"><a class="markdownIt-Anchor" href="#demo运行相关"></a> Demo运行相关</h3><p><span id="jump3" style="font-weight:bold;">[ImportError: No module named ‘pycocotools’]</span></p><p>问题原因: coco库没有成功安装</p><p>解决方法: <a href="#jump6">安装coco库</a></p><p><span id="jump4" style="font-weight:bold;">[AttributeError: ‘str’ object has no attribute ‘decode’]</span></p><p>问题原因: h5py的版本过高，大于了3.0</p><p>解决方法: <a href="https://github.com/keras-team/keras/issues/14265">参考网页</a></p><pre class="language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> <span class="token assign-left variable">h5py</span><span class="token operator">==</span><span class="token number">2.10</span>.0</code></pre><p><img src="/img/article/2021/05/16/14.png" alt="" /></p><p>安装时要关闭jupyter notebook以防止 h5py文件夹被占用，无法写入h5py2.10.0进行覆盖</p><p><span id="jump5" style="font-weight:bold;">[AttributeError:module ‘scipy.misc’ has no attribute ‘imresize’]</span></p><p>问题原因: scipy的版本过高</p><p>解决方法: <a href="https://stackoverflow.com/questions/56204985/how-to-fix-scipy-misc-has-no-attribute-imresize">参考网页</a></p><pre class="language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> <span class="token assign-left variable">scipy</span><span class="token operator">==</span><span class="token number">1.2</span>.2</code></pre><p><img src="/img/article/2021/05/16/15.png" alt="" /></p><p>安装时要关闭jupyter notebook以防止 scipy文件夹被占用，无法写入scipy1.2.2进行覆盖</p><p>至此，本文结束，感谢阅读！</p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>卷积神经网络</tag>
      
      <tag>计算机视觉</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>密码文章测试</title>
    <link href="/2021/05/04/Diary/20210504-%E9%9A%8F%E6%84%8F%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/05/04/Diary/20210504-%E9%9A%8F%E6%84%8F%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4396f566be317e10a2ddeb6e5e3e3b2e6f62aa575437c3c19957bfc521e100f6">10d79030e8222445804370796b90fca137368a758ff1e0290f9ccb56396bdfee34be4d9e4d03c00b6264c747a4adf98d329fedd9bf054613f907fd75d03ee87d7fae7080e8d49bc5ba7bb12120897cbff51eccd0c1f00178af7206883381cff22567c35a6c156f19e5ecd7ea83e73718255980ed0cd7e01e11c62b8f8581a110b72d7d3d270503158fcc56ec6fa47d9e5ca2856f757866abe33ac8cefc0bb3d024e86c13620f6aa22ad10791953f505c6b87f84adccf483cd128127f6c018dde589ba4ef48267aa16d0f793e034d6443f8e8042fe39504e45fc8a86105a6d0087ea516573b8b40406f8aee38d763b945add8341c5a40a9861068e9666d05a699051cc7bebfd7ed9ce59bb07d5c13c1a6ac76b451f866090f3be89351351cc13d8932fd56ca345713e0f418d7830ac0252ce6b17662076513d12037980d3149339d785ccdc3a2b29b95ebaa3d2f58860c47edb480ca09d6901d1539bb0a4f4e9b4a53a44a3fcf98061bf515a4c764c7e568ce6e3ca5e3eca7ec56b451409b6360510933c0b7ce694061629dadb3c5301d0a39bb180f024926979fa682d7da170023e4f7ae6c34faa89e256c8ba20fec21</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Plz enter the password.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>虚拟机VMware搭建Hadoop3.2.2</title>
    <link href="/2021/03/31/AI-Learning/20210331-VMware%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%90%AD%E5%BB%BAHadoop3/"/>
    <url>/2021/03/31/AI-Learning/20210331-VMware%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%90%AD%E5%BB%BAHadoop3/</url>
    
    <content type="html"><![CDATA[<h2 id="1准备linux主机环境"><a class="markdownIt-Anchor" href="#1准备linux主机环境"></a> 1.准备Linux主机环境</h2><p>VMware:  VMware Workstation 15Pro    <a href="https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html">VMware下载地址</a></p><p>CenOS:  CentOS-8.3.2011-x86_64-dvd1.iso    <a href="http://isoredirect.centos.org/centos/8/isos/x86_64/">CenOS下载地址</a></p><p>免密登录 可以帮助解决Permission denied（publickey,gssapi-keyex,gssapi-with-mic)）</p><p><strong>Step1</strong>: 安装Vmware Workstation 15Pro</p><p>​       该步骤不是实验内容核心，具体省略跳过。</p><p><strong>Step2</strong>: 安装3台CenOS8虚拟机</p><p>由于不是实验内容核心，这里只放我所参照的教程:</p><p>Vmware安装CenOS8: <a href="https://www.cnblogs.com/Dear-XiaoLe/articles/12201099.html">https://www.cnblogs.com/Dear-XiaoLe/articles/12201099.html</a></p><p>​       按照教程配置，成功创建3台CenOS虚拟机</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Git命令推送简记</title>
    <link href="/2020/07/29/Programing/20200729-Git%E5%91%BD%E4%BB%A4%E7%AE%80%E8%AE%B0/"/>
    <url>/2020/07/29/Programing/20200729-Git%E5%91%BD%E4%BB%A4%E7%AE%80%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="git-help"><a class="markdownIt-Anchor" href="#git-help"></a> Git-Help</h1><p>Git命令基础操作=&gt;自用</p><h2 id="本地推送流程"><a class="markdownIt-Anchor" href="#本地推送流程"></a> 本地推送流程</h2><ul><li><p><strong>Step1</strong>: 右键=&gt; git bash here,弹出git命令行窗口</p></li><li><p><strong>Step2</strong>: 初始化本地仓库</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> init</code></pre><blockquote><p>本地默认创建主分支master</p></blockquote></li><li><p><strong>Step3</strong>: 本地仓库链接远程仓库</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote <span class="token function">add</span> <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>远程仓库名<span class="token variable">`</span></span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>远程仓库地址<span class="token variable">`</span></span><span class="token punctuation">]</span></code></pre><blockquote><p>这里的远程仓库名，习惯上一般使用 origin</p></blockquote></li><li><p><strong>Step4</strong>: 查看本地仓库状态</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> status  </code></pre><blockquote><p>该命令显示已修改但未同步的文件</p></blockquote></li><li><p><strong>Step5</strong>: 将文件同步添加到暂存区</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>状态里的新文件<span class="token variable">`</span></span><span class="token punctuation">]</span>  </code></pre><blockquote><p>可用git add -A一键添加</p></blockquote></li><li><p><strong>Step6</strong>: 将文件添加到仓库</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">'[<span class="token variable"><span class="token variable">`</span>相关注释文字<span class="token variable">`</span></span>]'</span> </code></pre><blockquote><p>注意-m后的 注释文字要用引号</p></blockquote></li><li><p><strong>Step7</strong>: 将本地某分支推送到远程仓库，如果远程没有此分支会自动创建该分支，默认为master</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> push origin <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>本地分支名<span class="token variable">`</span></span><span class="token punctuation">]</span></code></pre><blockquote><p>origin 为上面提到的默认远程仓库名</p></blockquote></li></ul><hr /><h2 id="tips额外需求"><a class="markdownIt-Anchor" href="#tips额外需求"></a> Tips[额外需求]</h2><h3 id="git-add"><a class="markdownIt-Anchor" href="#git-add"></a> git add</h3><ol><li>一键添加</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> -A</code></pre><p><em># Changes to be committed:</em></p><p><em>#   new file:   add-me</em></p><p><em>#   modified:   change-me</em></p><p><em>#   deleted:    delete-me</em></p><blockquote><p>​可以一键添加所有未跟踪(new)、修改(modified)、被删除(deleted)文件，修改本地仓库再次提交很方便</p></blockquote><h3 id="git-push-origin"><a class="markdownIt-Anchor" href="#git-push-origin"></a> git push origin</h3><ol><li>删除远程仓库的指定远程分支</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> push origin --delete <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>远程分支名<span class="token variable">`</span></span><span class="token punctuation">]</span></code></pre><ol start="2"><li>强制推送</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> push -f </code></pre><blockquote><p>用于解决一些本地和远程始终不能同步[当前git pull无效]的问题，比如</p><p>Updates were rejected because the tip of your current branch is behind  its remote counterpart. Integrate the remote changes(e.g.‘git pull …’) before pushing again.</p></blockquote><h3 id="git-remote"><a class="markdownIt-Anchor" href="#git-remote"></a> git remote</h3><ol><li>查看远程仓库</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote</code></pre><blockquote><p>显示当前已链接的<code>[远程仓库名]</code>  (但不显示远程仓库地址)</p></blockquote><ol start="2"><li>取消指定链接的远程仓库</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote remove <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>远程仓库名<span class="token variable">`</span></span><span class="token punctuation">]</span>   </code></pre><ol start="3"><li>链接的远程仓库端口不是默认的port:22</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote origin ssh://<span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>用户名<span class="token variable">`</span></span><span class="token punctuation">]</span>@xx.xx.xx.xx:<span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>端口号<span class="token variable">`</span></span><span class="token punctuation">]</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/xxx.git</code></pre><blockquote><p>当远程开放的ssh不是port:22时，使用2、3命令重写绑定链接远程仓库</p><p><strong>PS</strong>:一般github的.git开放ssh端口都是port:22，不用管这个;</p><p>git远程推送你自己的云服务器时，需要查看你自己设定的ssh端口,当然一般也是port:22，但可自主修改</p></blockquote><h2 id="常见问题"><a class="markdownIt-Anchor" href="#常见问题"></a> 常见问题</h2><ul><li><p>Step7推送时: error: src refspec <code>[branchName]</code> does not match any</p><p>修改本地分支名称</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> branch -m <span class="token punctuation">[</span>oldBranchName<span class="token punctuation">]</span> <span class="token punctuation">[</span>newBranchName<span class="token punctuation">]</span></code></pre></li></ul>]]></content>
    
    
    <categories>
      
      <category>常用命令</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>置顶文章测试</title>
    <link href="/2019/10/10/20191010-Test/"/>
    <url>/2019/10/10/20191010-Test/</url>
    
    <content type="html"><![CDATA[<p>这里是正文内容，可以使用html和markdown的格式。</p>]]></content>
    
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>Fluid</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
